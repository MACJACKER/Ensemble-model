<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>simpleEnsembleGuide</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">simpleEnsembleGuide</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(simpleEnsembleGroup8)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This tutorial covers various regression models including linear,
ridge, lasso, and elastic net models, as well as ensemble methods and
comparisons of these models using the iris and mtcars datasets. We will
have 3 main data sets including continuous, binary, and in the case
where p &gt;&gt; n. Each of these data sets will be used to demonstrate
how to fit into the model of this package</p>
</div>
<div id="continous-tutorial" class="section level1">
<h1>Continous Tutorial</h1>
<div id="linear-model-function-validation-and-comparison" class="section level2">
<h2>Linear Model Function validation and comparison</h2>
<p>Background : In this we are comparing the results between the linear
model we created and the r built-in model Step 1: Load the Data Step 2:
Fit the Custom Linear Model or our model and then print the summary of
the model Step 3: Fit the Model Using R’s Built-in Function and then
print the summary of the model Step 4: Check the o/p to see if they are
same</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>test_model <span class="ot">&lt;-</span> <span class="fu">fit_linear_model</span>(iris<span class="sc">$</span>Sepal.Length, iris[, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">add_intercept =</span> <span class="cn">TRUE</span>, <span class="at">bagging =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; Matrix X is singular. Using SVD to compute coefficients.</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">print</span>(test_model<span class="sc">$</span>summary)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;                Estimate   StdError    tValue          Prt</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; Intercept     4.1905824 0.09704587 43.181459 2.092645e-85</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; Petal.Length  0.5417772 0.06928179  7.819907 9.414477e-13</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; Petal.Width  -0.3195506 0.16045262 -1.991557 4.827246e-02</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#Comparing with r builtin results</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> Petal.Length <span class="sc">+</span> Petal.Width, <span class="at">data =</span> iris)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; lm(formula = Sepal.Length ~ Petal.Length + Petal.Width, data = iris)</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; -1.18534 -0.29838 -0.02763  0.28925  1.02320 </span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt; (Intercept)   4.19058    0.09705  43.181  &lt; 2e-16 ***</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; Petal.Length  0.54178    0.06928   7.820 9.41e-13 ***</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; Petal.Width  -0.31955    0.16045  -1.992   0.0483 *  </span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.4031 on 147 degrees of freedom</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7663, Adjusted R-squared:  0.7631 </span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt; F-statistic:   241 on 2 and 147 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div id="model-fitting-and-prediction" class="section level2">
<h2>Model fitting and prediction</h2>
<p>All of the models will follow those procedure</p>
<p>Step 1: Load the Data Step 2: Split the dataset into training and
testing sets (70:30) Step 3: Fit our Model on the training dataset and
then fit the predict model on the test dataset Step 4: Print the summary
of the fitted training dataset Step 5: Print the predictions of the test
data</p>
<p>At the end, the ensemble function will be called and allow the users
to fit multiple models at the same time</p>
</div>
<div id="linear-model" class="section level2">
<h2>Linear Model</h2>
</div>
<div id="datasplit-liner-regression" class="section level2">
<h2>70:30 datasplit liner regression</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Load the iris dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># Convert species to a numeric factor for regression; let&#39;s predict Sepal.Length</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>iris<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(iris<span class="sc">$</span>Species))</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># Splitting the dataset into training and testing sets (70:30)</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(iris))</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(iris)), <span class="at">size =</span> sample_size)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>train <span class="ot">&lt;-</span> iris[train_indices, ]</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>test <span class="ot">&lt;-</span> iris[<span class="sc">-</span>train_indices, ]</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># Selecting predictors and the response variable</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>train_X <span class="ot">&lt;-</span> train[, <span class="fu">c</span>(<span class="st">&quot;Sepal.Width&quot;</span>, <span class="st">&quot;Petal.Length&quot;</span>, <span class="st">&quot;Petal.Width&quot;</span>, <span class="st">&quot;Species&quot;</span>)]</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>train_y <span class="ot">&lt;-</span> train<span class="sc">$</span>Sepal.Length</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>test_X <span class="ot">&lt;-</span> test[, <span class="fu">c</span>(<span class="st">&quot;Sepal.Width&quot;</span>, <span class="st">&quot;Petal.Length&quot;</span>, <span class="st">&quot;Petal.Width&quot;</span>, <span class="st">&quot;Species&quot;</span>)]</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co"># Fit the model using the training data</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>fitted_model <span class="ot">&lt;-</span> <span class="fu">fit_linear_model</span>(train_y, train_X, <span class="at">add_intercept =</span> <span class="cn">TRUE</span>, <span class="at">bagging =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; Matrix X is singular. Using SVD to compute coefficients.</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co"># Make predictions on the testing set</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict_model</span>(fitted_model, test_X, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co"># Print the model summary and predictions</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="fu">print</span>(fitted_model<span class="sc">$</span>summary)</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt;                Estimate   StdError    tValue          Prt</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt; Intercept     2.0932889 0.32740144  6.393646 5.216686e-09</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt; Sepal.Width   0.6070947 0.08187518  7.414881 4.023539e-11</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt; Petal.Length  0.7713866 0.07038452 10.959606 7.881794e-19</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co">#&gt; Petal.Width  -0.4546336 0.18619942 -2.441649 1.637676e-02</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#&gt; Species      -0.2282904 0.13977582 -1.633261 1.055588e-01</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="fu">print</span>(predictions)</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co">#&gt;         [,1]</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="co">#&gt; 1   4.978845</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="co">#&gt; 2   4.675297</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">#&gt; 3   4.719577</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="co">#&gt; 5   5.039554</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co">#&gt; 11  5.177402</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="co">#&gt; 18  4.933381</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="co">#&gt; 19  5.346926</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="co">#&gt; 28  5.055983</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="co">#&gt; 29  4.918135</span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="co">#&gt; 33  5.465703</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="co">#&gt; 36  4.642439</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="co">#&gt; 45  5.455740</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a><span class="co">#&gt; 48  4.796716</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="co">#&gt; 49  5.177402</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a><span class="co">#&gt; 55  6.203001</span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="co">#&gt; 56  6.216789</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="co">#&gt; 57  6.538224</span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="co">#&gt; 58  5.184678</span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a><span class="co">#&gt; 59  6.354637</span></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a><span class="co">#&gt; 61  5.096117</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a><span class="co">#&gt; 62  6.015866</span></span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a><span class="co">#&gt; 65  5.583251</span></span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a><span class="co">#&gt; 66  6.276316</span></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a><span class="co">#&gt; 68  5.983915</span></span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a><span class="co">#&gt; 70  5.662756</span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a><span class="co">#&gt; 77  6.402742</span></span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a><span class="co">#&gt; 83  5.738711</span></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a><span class="co">#&gt; 84  6.482522</span></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a><span class="co">#&gt; 94  5.123968</span></span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a><span class="co">#&gt; 95  5.924664</span></span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a><span class="co">#&gt; 98  6.123221</span></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a><span class="co">#&gt; 100 5.908235</span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a><span class="co">#&gt; 101 6.903566</span></span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a><span class="co">#&gt; 104 6.670417</span></span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a><span class="co">#&gt; 105 6.703550</span></span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a><span class="co">#&gt; 111 6.375925</span></span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a><span class="co">#&gt; 113 6.517598</span></span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a><span class="co">#&gt; 116 6.393812</span></span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a><span class="co">#&gt; 125 6.854003</span></span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a><span class="co">#&gt; 131 6.949937</span></span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a><span class="co">#&gt; 133 6.427854</span></span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a><span class="co">#&gt; 135 6.670142</span></span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a><span class="co">#&gt; 140 6.501168</span></span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a><span class="co">#&gt; 141 6.519056</span></span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a><span class="co">#&gt; 145 6.672150</span></span></code></pre></div>
</div>
<div id="ridge-model-function" class="section level2">
<h2>Ridge Model Function</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Load the iris dataset if not already loaded</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># Setting up the predictors and the target variable for Gaussian model</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>X_gaussian <span class="ot">&lt;-</span> iris[, <span class="fu">c</span>(<span class="st">&quot;Sepal.Width&quot;</span>, <span class="st">&quot;Petal.Width&quot;</span>, <span class="st">&quot;Sepal.Length&quot;</span>)]</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>y_gaussian <span class="ot">&lt;-</span> iris<span class="sc">$</span>Petal.Length</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co"># Splitting the dataset into training and testing sets (70:30)</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(iris))</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(iris)), <span class="at">size =</span> sample_size)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>train_X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_gaussian[train_indices, ])</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>train_y <span class="ot">&lt;-</span> y_gaussian[train_indices]</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>test_X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_gaussian[<span class="sc">-</span>train_indices, ])</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>test_y <span class="ot">&lt;-</span> y_gaussian[<span class="sc">-</span>train_indices]</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co"># Fit the ridge regression model using the training data</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>fitted_ridge_model <span class="ot">&lt;-</span> <span class="fu">fit_ridge_model</span>(train_y, train_X, <span class="at">model_type =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">add_intercept =</span> <span class="cn">TRUE</span>, <span class="at">bagging =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co"># Print the fitted model&#39;s details for inspection</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="fu">print</span>(fitted_ridge_model<span class="sc">$</span>model)  <span class="co"># Print the model object itself if needed</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; Call:  glmnet(x = as.matrix(X), y = y, family = model_type, alpha = 0,      lambda = lambda, intercept = add_intercept) </span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt;   Df  %Dev Lambda</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; 1  3 96.52 0.1725</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="fu">print</span>(fitted_ridge_model<span class="sc">$</span>coefficients)  <span class="co"># Coefficients of the fitted model</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; 4 x 1 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt;                      s1</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.4032843</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt; Sepal.Width  -0.6318430</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt; Petal.Width   1.2937330</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="co">#&gt; Sepal.Length  0.7768602</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="co"># Make predictions on the testing set</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict_model</span>(fitted_ridge_model, test_X, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a><span class="co"># Print predictions</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a><span class="fu">print</span>(test_predictions)</span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a><span class="co">#&gt; 45 x 1 Matrix of class &quot;dgeMatrix&quot;</span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a><span class="co">#&gt;           s1</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a><span class="co">#&gt; 1   1.605999</span></span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a><span class="co">#&gt; 2   1.766548</span></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a><span class="co">#&gt; 3   1.484808</span></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a><span class="co">#&gt; 5   1.465129</span></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a><span class="co">#&gt; 11  1.712688</span></span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a><span class="co">#&gt; 18  1.735372</span></span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a><span class="co">#&gt; 19  2.011935</span></span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a><span class="co">#&gt; 28  1.683685</span></span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a><span class="co">#&gt; 29  1.746869</span></span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a><span class="co">#&gt; 33  1.175206</span></span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a><span class="co">#&gt; 36  1.717866</span></span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a><span class="co">#&gt; 45  1.675193</span></span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a><span class="co">#&gt; 48  1.407122</span></span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a><span class="co">#&gt; 49  1.635002</span></span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a><span class="co">#&gt; 55  4.817746</span></span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a><span class="co">#&gt; 56  3.937511</span></span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a><span class="co">#&gt; 57  4.475826</span></span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a><span class="co">#&gt; 58  3.180641</span></span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a><span class="co">#&gt; 59  4.573501</span></span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a><span class="co">#&gt; 61  3.511064</span></span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a><span class="co">#&gt; 62  4.225261</span></span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a><span class="co">#&gt; 65  3.796641</span></span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a><span class="co">#&gt; 66  4.654192</span></span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a><span class="co">#&gt; 68  3.690262</span></span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a><span class="co">#&gt; 70  3.790632</span></span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a><span class="co">#&gt; 77  4.921431</span></span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a><span class="co">#&gt; 83  3.949008</span></span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a><span class="co">#&gt; 84  4.621874</span></span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a><span class="co">#&gt; 94  3.321511</span></span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a><span class="co">#&gt; 95  3.923010</span></span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a><span class="co">#&gt; 98  4.262757</span></span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a><span class="co">#&gt; 100 3.937511</span></span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a><span class="co">#&gt; 101 5.640186</span></span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a><span class="co">#&gt; 104 4.987310</span></span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a><span class="co">#&gt; 105 5.596991</span></span>
<span id="cb4-77"><a href="#cb4-77" tabindex="-1"></a><span class="co">#&gt; 111 5.211876</span></span>
<span id="cb4-78"><a href="#cb4-78" tabindex="-1"></a><span class="co">#&gt; 113 5.700675</span></span>
<span id="cb4-79"><a href="#cb4-79" tabindex="-1"></a><span class="co">#&gt; 116 5.522309</span></span>
<span id="cb4-80"><a href="#cb4-80" tabindex="-1"></a><span class="co">#&gt; 125 5.433437</span></span>
<span id="cb4-81"><a href="#cb4-81" tabindex="-1"></a><span class="co">#&gt; 131 6.034414</span></span>
<span id="cb4-82"><a href="#cb4-82" tabindex="-1"></a><span class="co">#&gt; 133 5.645673</span></span>
<span id="cb4-83"><a href="#cb4-83" tabindex="-1"></a><span class="co">#&gt; 135 4.503997</span></span>
<span id="cb4-84"><a href="#cb4-84" tabindex="-1"></a><span class="co">#&gt; 140 5.715177</span></span>
<span id="cb4-85"><a href="#cb4-85" tabindex="-1"></a><span class="co">#&gt; 141 5.947925</span></span>
<span id="cb4-86"><a href="#cb4-86" tabindex="-1"></a><span class="co">#&gt; 145 5.950930</span></span></code></pre></div>
</div>
<div id="lasso-model-function" class="section level2">
<h2>Lasso Model Function</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Load the iris dataset if not already loaded</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># Setting up the predictors and the target variable for Gaussian model</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>X_gaussian <span class="ot">&lt;-</span> iris[, <span class="fu">c</span>(<span class="st">&quot;Sepal.Width&quot;</span>, <span class="st">&quot;Petal.Width&quot;</span>, <span class="st">&quot;Sepal.Length&quot;</span>)]</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>y_gaussian <span class="ot">&lt;-</span> iris<span class="sc">$</span>Petal.Length</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co"># Splitting the dataset into training and testing sets (70:30)</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(iris))</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(iris)), <span class="at">size =</span> sample_size)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>train_X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_gaussian[train_indices, ])</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>train_y <span class="ot">&lt;-</span> y_gaussian[train_indices]</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>test_X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_gaussian[<span class="sc">-</span>train_indices, ])</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>test_y <span class="ot">&lt;-</span> y_gaussian[<span class="sc">-</span>train_indices]</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co"># Fit the lasso regression model using the training data</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>fitted_lasso_model <span class="ot">&lt;-</span> <span class="fu">fit_lasso_model</span>(train_y, train_X, <span class="at">model_type =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">add_intercept =</span> <span class="cn">TRUE</span>, <span class="at">bagging =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co"># Print the fitted model&#39;s details for inspection</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="fu">print</span>(fitted_lasso_model<span class="sc">$</span>model)  <span class="co"># Print the model object itself if needed</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; Call:  glmnet(x = as.matrix(X), y = y, family = model_type, alpha = 1,      lambda = lambda, intercept = add_intercept) </span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt;   Df  %Dev   Lambda</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; 1  3 96.81 0.008585</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="fu">print</span>(fitted_lasso_model<span class="sc">$</span>coefficients)  <span class="co"># Coefficients of the fitted model</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; 4 x 1 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt;                      s1</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.4448558</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co">#&gt; Sepal.Width  -0.5710399</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="co">#&gt; Petal.Width   1.4783139</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="co">#&gt; Sepal.Length  0.7142519</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="co"># Make predictions on the testing set</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict_model</span>(fitted_lasso_model, test_X, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="co"># Print predictions</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="fu">print</span>(test_predictions)</span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a><span class="co">#&gt; 45 x 1 Matrix of class &quot;dgeMatrix&quot;</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="co">#&gt;           s1</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="co">#&gt; 1   1.494852</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a><span class="co">#&gt; 2   1.637521</span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a><span class="co">#&gt; 3   1.380463</span></span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a><span class="co">#&gt; 5   1.366323</span></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a><span class="co">#&gt; 11  1.594919</span></span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a><span class="co">#&gt; 18  1.642683</span></span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a><span class="co">#&gt; 19  1.899922</span></span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a><span class="co">#&gt; 28  1.566277</span></span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a><span class="co">#&gt; 29  1.623381</span></span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a><span class="co">#&gt; 33  1.075822</span></span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a><span class="co">#&gt; 36  1.594739</span></span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a><span class="co">#&gt; 45  1.619203</span></span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a><span class="co">#&gt; 48  1.309038</span></span>
<span id="cb5-49"><a href="#cb5-49" tabindex="-1"></a><span class="co">#&gt; 49  1.523494</span></span>
<span id="cb5-50"><a href="#cb5-50" tabindex="-1"></a><span class="co">#&gt; 55  4.816340</span></span>
<span id="cb5-51"><a href="#cb5-51" tabindex="-1"></a><span class="co">#&gt; 56  3.949276</span></span>
<span id="cb5-52"><a href="#cb5-52" tabindex="-1"></a><span class="co">#&gt; 57  4.535801</span></span>
<span id="cb5-53"><a href="#cb5-53" tabindex="-1"></a><span class="co">#&gt; 58  3.162796</span></span>
<span id="cb5-54"><a href="#cb5-54" tabindex="-1"></a><span class="co">#&gt; 59  4.534999</span></span>
<span id="cb5-55"><a href="#cb5-55" tabindex="-1"></a><span class="co">#&gt; 61  3.462638</span></span>
<span id="cb5-56"><a href="#cb5-56" tabindex="-1"></a><span class="co">#&gt; 62  4.273581</span></span>
<span id="cb5-57"><a href="#cb5-57" tabindex="-1"></a><span class="co">#&gt; 65  3.820747</span></span>
<span id="cb5-58"><a href="#cb5-58" tabindex="-1"></a><span class="co">#&gt; 66  4.640047</span></span>
<span id="cb5-59"><a href="#cb5-59" tabindex="-1"></a><span class="co">#&gt; 68  3.634311</span></span>
<span id="cb5-60"><a href="#cb5-60" tabindex="-1"></a><span class="co">#&gt; 70  3.753500</span></span>
<span id="cb5-61"><a href="#cb5-61" tabindex="-1"></a><span class="co">#&gt; 77  4.882784</span></span>
<span id="cb5-62"><a href="#cb5-62" tabindex="-1"></a><span class="co">#&gt; 83  3.929974</span></span>
<span id="cb5-63"><a href="#cb5-63" tabindex="-1"></a><span class="co">#&gt; 84  4.664150</span></span>
<span id="cb5-64"><a href="#cb5-64" tabindex="-1"></a><span class="co">#&gt; 94  3.291326</span></span>
<span id="cb5-65"><a href="#cb5-65" tabindex="-1"></a><span class="co">#&gt; 95  3.934955</span></span>
<span id="cb5-66"><a href="#cb5-66" tabindex="-1"></a><span class="co">#&gt; 98  4.249298</span></span>
<span id="cb5-67"><a href="#cb5-67" tabindex="-1"></a><span class="co">#&gt; 100 3.949276</span></span>
<span id="cb5-68"><a href="#cb5-68" tabindex="-1"></a><span class="co">#&gt; 101 5.866284</span></span>
<span id="cb5-69"><a href="#cb5-69" tabindex="-1"></a><span class="co">#&gt; 104 5.059880</span></span>
<span id="cb5-70"><a href="#cb5-70" tabindex="-1"></a><span class="co">#&gt; 105 5.736952</span></span>
<span id="cb5-71"><a href="#cb5-71" tabindex="-1"></a><span class="co">#&gt; 111 5.327081</span></span>
<span id="cb5-72"><a href="#cb5-72" tabindex="-1"></a><span class="co">#&gt; 113 5.803396</span></span>
<span id="cb5-73"><a href="#cb5-73" tabindex="-1"></a><span class="co">#&gt; 116 5.699150</span></span>
<span id="cb5-74"><a href="#cb5-74" tabindex="-1"></a><span class="co">#&gt; 125 5.560659</span></span>
<span id="cb5-75"><a href="#cb5-75" tabindex="-1"></a><span class="co">#&gt; 131 6.050493</span></span>
<span id="cb5-76"><a href="#cb5-76" tabindex="-1"></a><span class="co">#&gt; 133 5.779735</span></span>
<span id="cb5-77"><a href="#cb5-77" tabindex="-1"></a><span class="co">#&gt; 135 4.497016</span></span>
<span id="cb5-78"><a href="#cb5-78" tabindex="-1"></a><span class="co">#&gt; 140 5.817717</span></span>
<span id="cb5-79"><a href="#cb5-79" tabindex="-1"></a><span class="co">#&gt; 141 6.118361</span></span>
<span id="cb5-80"><a href="#cb5-80" tabindex="-1"></a><span class="co">#&gt; 145 6.151985</span></span></code></pre></div>
</div>
<div id="elastic-net-model-function" class="section level2">
<h2>Elastic Net Model Function</h2>
<p>this function will test in a case of bagging = TRUE. It takes a
dataset, repeatedly samples from it with replacement, fits a model on
each sample, and then averages the results to improve model stability
and accuracy. It computes averaged coefficients, standard errors,
t-values, p-values, and variable importance scores.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Load the iris dataset</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co"># Prepare Gaussian model data</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>X_gaussian <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(iris[, <span class="fu">c</span>(<span class="st">&quot;Sepal.Width&quot;</span>, <span class="st">&quot;Petal.Width&quot;</span>, <span class="st">&quot;Sepal.Length&quot;</span>)])</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>y_gaussian <span class="ot">&lt;-</span> iris<span class="sc">$</span>Petal.Length</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co"># Splitting the dataset into training and testing sets (70:30)</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(iris))</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(iris)), <span class="at">size =</span> sample_size)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>train_X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_gaussian[train_indices, ])</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>train_y <span class="ot">&lt;-</span> y_gaussian[train_indices]</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>test_X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_gaussian[<span class="sc">-</span>train_indices, ])</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>test_y <span class="ot">&lt;-</span> y_gaussian[<span class="sc">-</span>train_indices]</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co"># Fit Elastic Net for Gaussian model without bagging</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>result_elastic_net_gaussian <span class="ot">&lt;-</span> <span class="fu">fit_elastic_net_model</span>(train_y, train_X, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">model_type =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">add_intercept =</span> <span class="cn">TRUE</span>, <span class="at">bagging =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="fu">print</span>(result_elastic_net_gaussian<span class="sc">$</span>model)</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; Call:  glmnet(x = as.matrix(X), y = y, family = model_type, alpha = alpha,      lambda = lambda, intercept = add_intercept) </span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt;   Df  %Dev  Lambda</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; 1  3 96.81 0.01299</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co"># Make predictions on the testing set(without bagging)</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict_model</span>(fitted_lasso_model, test_X, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co"># Print predictions</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="fu">print</span>(test_predictions)</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; 45 x 1 Matrix of class &quot;dgeMatrix&quot;</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt;             s1</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt;  [1,] 1.494852</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.637521</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt;  [3,] 1.380463</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co">#&gt;  [4,] 1.366323</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.594919</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co">#&gt;  [6,] 1.642683</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co">#&gt;  [7,] 1.899922</span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co">#&gt;  [8,] 1.566277</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="co">#&gt;  [9,] 1.623381</span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a><span class="co">#&gt; [10,] 1.075822</span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a><span class="co">#&gt; [11,] 1.594739</span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a><span class="co">#&gt; [12,] 1.619203</span></span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a><span class="co">#&gt; [13,] 1.309038</span></span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a><span class="co">#&gt; [14,] 1.523494</span></span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a><span class="co">#&gt; [15,] 4.816340</span></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a><span class="co">#&gt; [16,] 3.949276</span></span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a><span class="co">#&gt; [17,] 4.535801</span></span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a><span class="co">#&gt; [18,] 3.162796</span></span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a><span class="co">#&gt; [19,] 4.534999</span></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a><span class="co">#&gt; [20,] 3.462638</span></span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a><span class="co">#&gt; [21,] 4.273581</span></span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a><span class="co">#&gt; [22,] 3.820747</span></span>
<span id="cb6-52"><a href="#cb6-52" tabindex="-1"></a><span class="co">#&gt; [23,] 4.640047</span></span>
<span id="cb6-53"><a href="#cb6-53" tabindex="-1"></a><span class="co">#&gt; [24,] 3.634311</span></span>
<span id="cb6-54"><a href="#cb6-54" tabindex="-1"></a><span class="co">#&gt; [25,] 3.753500</span></span>
<span id="cb6-55"><a href="#cb6-55" tabindex="-1"></a><span class="co">#&gt; [26,] 4.882784</span></span>
<span id="cb6-56"><a href="#cb6-56" tabindex="-1"></a><span class="co">#&gt; [27,] 3.929974</span></span>
<span id="cb6-57"><a href="#cb6-57" tabindex="-1"></a><span class="co">#&gt; [28,] 4.664150</span></span>
<span id="cb6-58"><a href="#cb6-58" tabindex="-1"></a><span class="co">#&gt; [29,] 3.291326</span></span>
<span id="cb6-59"><a href="#cb6-59" tabindex="-1"></a><span class="co">#&gt; [30,] 3.934955</span></span>
<span id="cb6-60"><a href="#cb6-60" tabindex="-1"></a><span class="co">#&gt; [31,] 4.249298</span></span>
<span id="cb6-61"><a href="#cb6-61" tabindex="-1"></a><span class="co">#&gt; [32,] 3.949276</span></span>
<span id="cb6-62"><a href="#cb6-62" tabindex="-1"></a><span class="co">#&gt; [33,] 5.866284</span></span>
<span id="cb6-63"><a href="#cb6-63" tabindex="-1"></a><span class="co">#&gt; [34,] 5.059880</span></span>
<span id="cb6-64"><a href="#cb6-64" tabindex="-1"></a><span class="co">#&gt; [35,] 5.736952</span></span>
<span id="cb6-65"><a href="#cb6-65" tabindex="-1"></a><span class="co">#&gt; [36,] 5.327081</span></span>
<span id="cb6-66"><a href="#cb6-66" tabindex="-1"></a><span class="co">#&gt; [37,] 5.803396</span></span>
<span id="cb6-67"><a href="#cb6-67" tabindex="-1"></a><span class="co">#&gt; [38,] 5.699150</span></span>
<span id="cb6-68"><a href="#cb6-68" tabindex="-1"></a><span class="co">#&gt; [39,] 5.560659</span></span>
<span id="cb6-69"><a href="#cb6-69" tabindex="-1"></a><span class="co">#&gt; [40,] 6.050493</span></span>
<span id="cb6-70"><a href="#cb6-70" tabindex="-1"></a><span class="co">#&gt; [41,] 5.779735</span></span>
<span id="cb6-71"><a href="#cb6-71" tabindex="-1"></a><span class="co">#&gt; [42,] 4.497016</span></span>
<span id="cb6-72"><a href="#cb6-72" tabindex="-1"></a><span class="co">#&gt; [43,] 5.817717</span></span>
<span id="cb6-73"><a href="#cb6-73" tabindex="-1"></a><span class="co">#&gt; [44,] 6.118361</span></span>
<span id="cb6-74"><a href="#cb6-74" tabindex="-1"></a><span class="co">#&gt; [45,] 6.151985</span></span>
<span id="cb6-75"><a href="#cb6-75" tabindex="-1"></a></span>
<span id="cb6-76"><a href="#cb6-76" tabindex="-1"></a></span>
<span id="cb6-77"><a href="#cb6-77" tabindex="-1"></a><span class="co"># Fit Elastic Net for Gaussian model with bagging</span></span>
<span id="cb6-78"><a href="#cb6-78" tabindex="-1"></a>result_elastic_net_gaussian_bagging <span class="ot">&lt;-</span> <span class="fu">fit_elastic_net_model</span>(train_y, train_X, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">model_type =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">add_intercept =</span> <span class="cn">TRUE</span>, <span class="at">bagging =</span> <span class="cn">TRUE</span>, <span class="at">R =</span> <span class="dv">50</span>)</span>
<span id="cb6-79"><a href="#cb6-79" tabindex="-1"></a><span class="co">#&gt; Warning in .Ops.recycle.ind(e2, len = l1): longer object length</span></span>
<span id="cb6-80"><a href="#cb6-80" tabindex="-1"></a><span class="co">#&gt;  is not a multiple of shorter object length</span></span>
<span id="cb6-81"><a href="#cb6-81" tabindex="-1"></a><span class="fu">print</span>(result_elastic_net_gaussian_bagging)</span>
<span id="cb6-82"><a href="#cb6-82" tabindex="-1"></a><span class="co">#&gt; $coefficients</span></span>
<span id="cb6-83"><a href="#cb6-83" tabindex="-1"></a><span class="co">#&gt; [1] -0.4096428 -0.5748974  1.4734629  0.7114637</span></span>
<span id="cb6-84"><a href="#cb6-84" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-85"><a href="#cb6-85" tabindex="-1"></a><span class="co">#&gt; $se_coefficients</span></span>
<span id="cb6-86"><a href="#cb6-86" tabindex="-1"></a><span class="co">#&gt; [1] 0.055003379 0.011084210 0.009833079 0.009321412</span></span>
<span id="cb6-87"><a href="#cb6-87" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-88"><a href="#cb6-88" tabindex="-1"></a><span class="co">#&gt; $t_values</span></span>
<span id="cb6-89"><a href="#cb6-89" tabindex="-1"></a><span class="co">#&gt; [1]  -7.447594 -51.866340 149.847567  76.325744</span></span>
<span id="cb6-90"><a href="#cb6-90" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-91"><a href="#cb6-91" tabindex="-1"></a><span class="co">#&gt; $p_values</span></span>
<span id="cb6-92"><a href="#cb6-92" tabindex="-1"></a><span class="co">#&gt; [1]  3.284410e-11  1.297137e-74 1.900384e-120  3.924989e-91</span></span>
<span id="cb6-93"><a href="#cb6-93" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-94"><a href="#cb6-94" tabindex="-1"></a><span class="co">#&gt; $predictions</span></span>
<span id="cb6-95"><a href="#cb6-95" tabindex="-1"></a><span class="co">#&gt;   [1] 3.288583 4.279760 4.010834 3.504162 3.845149 4.076481 4.081319 3.580877</span></span>
<span id="cb6-96"><a href="#cb6-96" tabindex="-1"></a><span class="co">#&gt;   [9] 3.746234 3.803601 3.910750 3.854029 3.331532 3.906301 3.725326 3.807963</span></span>
<span id="cb6-97"><a href="#cb6-97" tabindex="-1"></a><span class="co">#&gt;  [17] 3.649234 4.000919 3.644074 3.708077 3.935664 3.961336 3.774493 3.685488</span></span>
<span id="cb6-98"><a href="#cb6-98" tabindex="-1"></a><span class="co">#&gt;  [25] 3.865053 3.806570 3.633232 3.887581 3.793743 3.655949 4.042498 3.124932</span></span>
<span id="cb6-99"><a href="#cb6-99" tabindex="-1"></a><span class="co">#&gt;  [33] 3.861594 3.573004 4.320250 3.728654 3.934800 3.771883 3.726324 3.592212</span></span>
<span id="cb6-100"><a href="#cb6-100" tabindex="-1"></a><span class="co">#&gt;  [41] 3.955677 3.815936 4.044967 3.833318 3.621375 3.975796 3.305757 3.424109</span></span>
<span id="cb6-101"><a href="#cb6-101" tabindex="-1"></a><span class="co">#&gt;  [49] 3.262809 3.798837 3.948135 4.190785 3.949812 3.902858 3.805572 4.027029</span></span>
<span id="cb6-102"><a href="#cb6-102" tabindex="-1"></a><span class="co">#&gt;  [57] 3.792226 3.898827 3.537347 3.199260 3.361704 3.704537 3.994142 3.881386</span></span>
<span id="cb6-103"><a href="#cb6-103" tabindex="-1"></a><span class="co">#&gt;  [65] 3.888180 3.909201 3.768963 3.745542 3.619910 3.864724 4.043406 4.078378</span></span>
<span id="cb6-104"><a href="#cb6-104" tabindex="-1"></a><span class="co">#&gt;  [73] 3.428355 3.994814 3.979308 3.410938 4.051729 3.769096 3.832268 3.124955</span></span>
<span id="cb6-105"><a href="#cb6-105" tabindex="-1"></a><span class="co">#&gt;  [81] 3.205075 3.882523 3.875982 3.500145 3.848587 3.779620 3.778707 3.911687</span></span>
<span id="cb6-106"><a href="#cb6-106" tabindex="-1"></a><span class="co">#&gt;  [89] 3.617350 3.000086 3.183284 3.979907 4.031516 3.985401 3.530115 4.138052</span></span>
<span id="cb6-107"><a href="#cb6-107" tabindex="-1"></a><span class="co">#&gt;  [97] 3.955828 3.754554 3.839624 3.643741 3.713437 4.039228 3.773083 3.754759</span></span>
<span id="cb6-108"><a href="#cb6-108" tabindex="-1"></a><span class="co">#&gt; [105] 3.729278</span></span>
<span id="cb6-109"><a href="#cb6-109" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-110"><a href="#cb6-110" tabindex="-1"></a><span class="co">#&gt; $variable_importance</span></span>
<span id="cb6-111"><a href="#cb6-111" tabindex="-1"></a><span class="co">#&gt; 4 x 1 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb6-112"><a href="#cb6-112" tabindex="-1"></a><span class="co">#&gt;              s0</span></span>
<span id="cb6-113"><a href="#cb6-113" tabindex="-1"></a><span class="co">#&gt; (Intercept)   1</span></span>
<span id="cb6-114"><a href="#cb6-114" tabindex="-1"></a><span class="co">#&gt; Sepal.Width   1</span></span>
<span id="cb6-115"><a href="#cb6-115" tabindex="-1"></a><span class="co">#&gt; Petal.Width   1</span></span>
<span id="cb6-116"><a href="#cb6-116" tabindex="-1"></a><span class="co">#&gt; Sepal.Length  1</span></span>
<span id="cb6-117"><a href="#cb6-117" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-118"><a href="#cb6-118" tabindex="-1"></a><span class="co">#&gt; $names</span></span>
<span id="cb6-119"><a href="#cb6-119" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Intercept&quot;    &quot;Sepal.Width&quot;  &quot;Petal.Width&quot;  &quot;Sepal.Length&quot;</span></span>
<span id="cb6-120"><a href="#cb6-120" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-121"><a href="#cb6-121" tabindex="-1"></a><span class="co">#&gt; $model_type</span></span>
<span id="cb6-122"><a href="#cb6-122" tabindex="-1"></a><span class="co">#&gt; [1] &quot;gaussian&quot;</span></span>
<span id="cb6-123"><a href="#cb6-123" tabindex="-1"></a></span>
<span id="cb6-124"><a href="#cb6-124" tabindex="-1"></a><span class="co"># Make predictions on the testing set(with bagging)</span></span>
<span id="cb6-125"><a href="#cb6-125" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict_model</span>(fitted_lasso_model, test_X, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb6-126"><a href="#cb6-126" tabindex="-1"></a><span class="co"># Print predictions</span></span>
<span id="cb6-127"><a href="#cb6-127" tabindex="-1"></a><span class="fu">print</span>(test_predictions) </span>
<span id="cb6-128"><a href="#cb6-128" tabindex="-1"></a><span class="co">#&gt; 45 x 1 Matrix of class &quot;dgeMatrix&quot;</span></span>
<span id="cb6-129"><a href="#cb6-129" tabindex="-1"></a><span class="co">#&gt;             s1</span></span>
<span id="cb6-130"><a href="#cb6-130" tabindex="-1"></a><span class="co">#&gt;  [1,] 1.494852</span></span>
<span id="cb6-131"><a href="#cb6-131" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.637521</span></span>
<span id="cb6-132"><a href="#cb6-132" tabindex="-1"></a><span class="co">#&gt;  [3,] 1.380463</span></span>
<span id="cb6-133"><a href="#cb6-133" tabindex="-1"></a><span class="co">#&gt;  [4,] 1.366323</span></span>
<span id="cb6-134"><a href="#cb6-134" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.594919</span></span>
<span id="cb6-135"><a href="#cb6-135" tabindex="-1"></a><span class="co">#&gt;  [6,] 1.642683</span></span>
<span id="cb6-136"><a href="#cb6-136" tabindex="-1"></a><span class="co">#&gt;  [7,] 1.899922</span></span>
<span id="cb6-137"><a href="#cb6-137" tabindex="-1"></a><span class="co">#&gt;  [8,] 1.566277</span></span>
<span id="cb6-138"><a href="#cb6-138" tabindex="-1"></a><span class="co">#&gt;  [9,] 1.623381</span></span>
<span id="cb6-139"><a href="#cb6-139" tabindex="-1"></a><span class="co">#&gt; [10,] 1.075822</span></span>
<span id="cb6-140"><a href="#cb6-140" tabindex="-1"></a><span class="co">#&gt; [11,] 1.594739</span></span>
<span id="cb6-141"><a href="#cb6-141" tabindex="-1"></a><span class="co">#&gt; [12,] 1.619203</span></span>
<span id="cb6-142"><a href="#cb6-142" tabindex="-1"></a><span class="co">#&gt; [13,] 1.309038</span></span>
<span id="cb6-143"><a href="#cb6-143" tabindex="-1"></a><span class="co">#&gt; [14,] 1.523494</span></span>
<span id="cb6-144"><a href="#cb6-144" tabindex="-1"></a><span class="co">#&gt; [15,] 4.816340</span></span>
<span id="cb6-145"><a href="#cb6-145" tabindex="-1"></a><span class="co">#&gt; [16,] 3.949276</span></span>
<span id="cb6-146"><a href="#cb6-146" tabindex="-1"></a><span class="co">#&gt; [17,] 4.535801</span></span>
<span id="cb6-147"><a href="#cb6-147" tabindex="-1"></a><span class="co">#&gt; [18,] 3.162796</span></span>
<span id="cb6-148"><a href="#cb6-148" tabindex="-1"></a><span class="co">#&gt; [19,] 4.534999</span></span>
<span id="cb6-149"><a href="#cb6-149" tabindex="-1"></a><span class="co">#&gt; [20,] 3.462638</span></span>
<span id="cb6-150"><a href="#cb6-150" tabindex="-1"></a><span class="co">#&gt; [21,] 4.273581</span></span>
<span id="cb6-151"><a href="#cb6-151" tabindex="-1"></a><span class="co">#&gt; [22,] 3.820747</span></span>
<span id="cb6-152"><a href="#cb6-152" tabindex="-1"></a><span class="co">#&gt; [23,] 4.640047</span></span>
<span id="cb6-153"><a href="#cb6-153" tabindex="-1"></a><span class="co">#&gt; [24,] 3.634311</span></span>
<span id="cb6-154"><a href="#cb6-154" tabindex="-1"></a><span class="co">#&gt; [25,] 3.753500</span></span>
<span id="cb6-155"><a href="#cb6-155" tabindex="-1"></a><span class="co">#&gt; [26,] 4.882784</span></span>
<span id="cb6-156"><a href="#cb6-156" tabindex="-1"></a><span class="co">#&gt; [27,] 3.929974</span></span>
<span id="cb6-157"><a href="#cb6-157" tabindex="-1"></a><span class="co">#&gt; [28,] 4.664150</span></span>
<span id="cb6-158"><a href="#cb6-158" tabindex="-1"></a><span class="co">#&gt; [29,] 3.291326</span></span>
<span id="cb6-159"><a href="#cb6-159" tabindex="-1"></a><span class="co">#&gt; [30,] 3.934955</span></span>
<span id="cb6-160"><a href="#cb6-160" tabindex="-1"></a><span class="co">#&gt; [31,] 4.249298</span></span>
<span id="cb6-161"><a href="#cb6-161" tabindex="-1"></a><span class="co">#&gt; [32,] 3.949276</span></span>
<span id="cb6-162"><a href="#cb6-162" tabindex="-1"></a><span class="co">#&gt; [33,] 5.866284</span></span>
<span id="cb6-163"><a href="#cb6-163" tabindex="-1"></a><span class="co">#&gt; [34,] 5.059880</span></span>
<span id="cb6-164"><a href="#cb6-164" tabindex="-1"></a><span class="co">#&gt; [35,] 5.736952</span></span>
<span id="cb6-165"><a href="#cb6-165" tabindex="-1"></a><span class="co">#&gt; [36,] 5.327081</span></span>
<span id="cb6-166"><a href="#cb6-166" tabindex="-1"></a><span class="co">#&gt; [37,] 5.803396</span></span>
<span id="cb6-167"><a href="#cb6-167" tabindex="-1"></a><span class="co">#&gt; [38,] 5.699150</span></span>
<span id="cb6-168"><a href="#cb6-168" tabindex="-1"></a><span class="co">#&gt; [39,] 5.560659</span></span>
<span id="cb6-169"><a href="#cb6-169" tabindex="-1"></a><span class="co">#&gt; [40,] 6.050493</span></span>
<span id="cb6-170"><a href="#cb6-170" tabindex="-1"></a><span class="co">#&gt; [41,] 5.779735</span></span>
<span id="cb6-171"><a href="#cb6-171" tabindex="-1"></a><span class="co">#&gt; [42,] 4.497016</span></span>
<span id="cb6-172"><a href="#cb6-172" tabindex="-1"></a><span class="co">#&gt; [43,] 5.817717</span></span>
<span id="cb6-173"><a href="#cb6-173" tabindex="-1"></a><span class="co">#&gt; [44,] 6.118361</span></span>
<span id="cb6-174"><a href="#cb6-174" tabindex="-1"></a><span class="co">#&gt; [45,] 6.151985</span></span></code></pre></div>
</div>
<div id="random-forest-model-function" class="section level2">
<h2>Random Forest Model Function</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Load the iris dataset</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># Prepare Gaussian model data</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>X_gaussian <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(iris[, <span class="fu">c</span>(<span class="st">&quot;Sepal.Width&quot;</span>, <span class="st">&quot;Petal.Width&quot;</span>, <span class="st">&quot;Sepal.Length&quot;</span>)])</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>y_gaussian <span class="ot">&lt;-</span> iris<span class="sc">$</span>Petal.Length</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># Splitting the dataset into training and testing sets (70:30)</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(iris))</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(iris)), <span class="at">size =</span> sample_size)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>train_X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_gaussian[train_indices, ])</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>train_y <span class="ot">&lt;-</span> y_gaussian[train_indices]</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>test_X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_gaussian[<span class="sc">-</span>train_indices, ])</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>test_y <span class="ot">&lt;-</span> y_gaussian[<span class="sc">-</span>train_indices]</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co"># Fit Random Forest for Gaussian model (Regression)</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>result_rf_gaussian <span class="ot">&lt;-</span> <span class="fu">fit_random_forest_model</span>(train_y, train_X, <span class="at">model_type =</span> <span class="st">&#39;gaussian&#39;</span>)</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="fu">print</span>(result_rf_gaussian<span class="sc">$</span>model)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt;  randomForest(x = X, y = y, type = &quot;regression&quot;) </span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt;                Type of random forest: regression</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt;                      Number of trees: 500</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; No. of variables tried at each split: 1</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt;           Mean of squared residuals: 0.11262</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt;                     % Var explained: 96.49</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co"># Make predictions on the testing set</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict_model</span>(result_rf_gaussian, test_X, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co"># Print predictions</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="fu">print</span>(test_predictions)</span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#&gt;        1        2        3        4        5        6        7        8 </span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a><span class="co">#&gt; 1.469852 1.582151 1.648354 1.441354 1.512877 1.437644 1.904005 1.502194 </span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="co">#&gt;        9       10       11       12       13       14       15       16 </span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="co">#&gt; 1.596741 1.460367 1.623577 1.608687 1.528225 1.533327 4.857553 4.211756 </span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a><span class="co">#&gt;       17       18       19       20       21       22       23       24 </span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a><span class="co">#&gt; 4.860880 3.414487 4.487865 3.447940 4.574927 4.240420 4.701854 4.022160 </span></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a><span class="co">#&gt;       25       26       27       28       29       30       31       32 </span></span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a><span class="co">#&gt; 3.837597 4.795751 4.218466 4.756281 3.406737 4.152281 4.402289 4.211756 </span></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a><span class="co">#&gt;       33       34       35       36       37       38       39       40 </span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a><span class="co">#&gt; 5.352286 5.039916 5.408741 5.340456 5.481812 5.429073 5.460152 6.104092 </span></span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a><span class="co">#&gt;       41       42       43       44       45 </span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a><span class="co">#&gt; 5.456875 4.445547 5.446095 5.328056 5.438590</span></span></code></pre></div>
</div>
<div id="ensemble-model-implemented-of-ridge-lasso-and-elastic-net-models" class="section level2">
<h2>Ensemble Model implemented of ridge, lasso and elastic-net
models</h2>
<p>Step 1: Load the Data Step 2: Extract X and y values Step 3: Pick
three models you want to do ensemble modelling on Step 4: Fit our
Ensemble Model Step 4: Print the combined predictions Step 5: Print the
model details</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Load the iris dataset </span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># Setting up the data</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> iris[, <span class="fu">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>, <span class="st">&quot;Sepal.Width&quot;</span>, <span class="st">&quot;Petal.Width&quot;</span>)]  <span class="co"># Exclude the target variable</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> iris<span class="sc">$</span>Petal.Length  <span class="co"># We will predict the Petal.Length</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co"># Define the list of model fitting functions</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;fit_elastic_net_model&quot;</span>, <span class="st">&quot;fit_ridge_model&quot;</span>, <span class="st">&quot;fit_lasso_model&quot;</span>)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co"># Fit the ensemble model using the training data</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>ensemble_results <span class="ot">&lt;-</span> <span class="fu">ensemble_model_fitting</span>(y, X, <span class="at">model_type =</span> <span class="st">&#39;gaussian&#39;</span>, <span class="at">model_list =</span> model_list)</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;fit_elastic_net_model&quot;</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;fit_ridge_model&quot;</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;fit_lasso_model&quot;</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co"># Print ensemble results and individual model details</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="fu">print</span>(ensemble_results<span class="sc">$</span>combined_predictions)</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; 150 x 1 Matrix of class &quot;dgeMatrix&quot;</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt;              s1</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt;   [1,] 1.534947</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt;   [2,] 1.710402</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt;   [3,] 1.431773</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt;   [4,] 1.422197</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt;   [5,] 1.395632</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt;   [6,] 1.775495</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt;   [7,] 1.365935</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt;   [8,] 1.525371</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt;   [9,] 1.403045</span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt;  [10,] 1.507188</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt;  [11,] 1.628544</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt;  [12,] 1.376480</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt;  [13,] 1.497612</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt;  [14,] 1.125386</span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt;  [15,] 1.731717</span></span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="co">#&gt;  [16,] 1.674485</span></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a><span class="co">#&gt;  [17,] 1.775495</span></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="co">#&gt;  [18,] 1.673291</span></span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a><span class="co">#&gt;  [19,] 1.925355</span></span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a><span class="co">#&gt;  [20,] 1.478684</span></span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a><span class="co">#&gt;  [21,] 1.823151</span></span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a><span class="co">#&gt;  [22,] 1.681898</span></span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a><span class="co">#&gt;  [23,] 1.097852</span></span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a><span class="co">#&gt;  [24,] 2.079719</span></span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a><span class="co">#&gt;  [25,] 1.376480</span></span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a><span class="co">#&gt;  [26,] 1.784847</span></span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a><span class="co">#&gt;  [27,] 1.802060</span></span>
<span id="cb8-48"><a href="#cb8-48" tabindex="-1"></a><span class="co">#&gt;  [28,] 1.609392</span></span>
<span id="cb8-49"><a href="#cb8-49" tabindex="-1"></a><span class="co">#&gt;  [29,] 1.674261</span></span>
<span id="cb8-50"><a href="#cb8-50" tabindex="-1"></a><span class="co">#&gt;  [30,] 1.431773</span></span>
<span id="cb8-51"><a href="#cb8-51" tabindex="-1"></a><span class="co">#&gt;  [31,] 1.571088</span></span>
<span id="cb8-52"><a href="#cb8-52" tabindex="-1"></a><span class="co">#&gt;  [32,] 2.099840</span></span>
<span id="cb8-53"><a href="#cb8-53" tabindex="-1"></a><span class="co">#&gt;  [33,] 1.081833</span></span>
<span id="cb8-54"><a href="#cb8-54" tabindex="-1"></a><span class="co">#&gt;  [34,] 1.378643</span></span>
<span id="cb8-55"><a href="#cb8-55" tabindex="-1"></a><span class="co">#&gt;  [35,] 1.645533</span></span>
<span id="cb8-56"><a href="#cb8-56" tabindex="-1"></a><span class="co">#&gt;  [36,] 1.655109</span></span>
<span id="cb8-57"><a href="#cb8-57" tabindex="-1"></a><span class="co">#&gt;  [37,] 1.832727</span></span>
<span id="cb8-58"><a href="#cb8-58" tabindex="-1"></a><span class="co">#&gt;  [38,] 1.182843</span></span>
<span id="cb8-59"><a href="#cb8-59" tabindex="-1"></a><span class="co">#&gt;  [39,] 1.338176</span></span>
<span id="cb8-60"><a href="#cb8-60" tabindex="-1"></a><span class="co">#&gt;  [40,] 1.599816</span></span>
<span id="cb8-61"><a href="#cb8-61" tabindex="-1"></a><span class="co">#&gt;  [41,] 1.598846</span></span>
<span id="cb8-62"><a href="#cb8-62" tabindex="-1"></a><span class="co">#&gt;  [42,] 2.005050</span></span>
<span id="cb8-63"><a href="#cb8-63" tabindex="-1"></a><span class="co">#&gt;  [43,] 1.208438</span></span>
<span id="cb8-64"><a href="#cb8-64" tabindex="-1"></a><span class="co">#&gt;  [44,] 2.013880</span></span>
<span id="cb8-65"><a href="#cb8-65" tabindex="-1"></a><span class="co">#&gt;  [45,] 1.617029</span></span>
<span id="cb8-66"><a href="#cb8-66" tabindex="-1"></a><span class="co">#&gt;  [46,] 1.774301</span></span>
<span id="cb8-67"><a href="#cb8-67" tabindex="-1"></a><span class="co">#&gt;  [47,] 1.340339</span></span>
<span id="cb8-68"><a href="#cb8-68" tabindex="-1"></a><span class="co">#&gt;  [48,] 1.357328</span></span>
<span id="cb8-69"><a href="#cb8-69" tabindex="-1"></a><span class="co">#&gt;  [49,] 1.554099</span></span>
<span id="cb8-70"><a href="#cb8-70" tabindex="-1"></a><span class="co">#&gt;  [50,] 1.590240</span></span>
<span id="cb8-71"><a href="#cb8-71" tabindex="-1"></a><span class="co">#&gt;  [51,] 4.804147</span></span>
<span id="cb8-72"><a href="#cb8-72" tabindex="-1"></a><span class="co">#&gt;  [52,] 4.495821</span></span>
<span id="cb8-73"><a href="#cb8-73" tabindex="-1"></a><span class="co">#&gt;  [53,] 4.932916</span></span>
<span id="cb8-74"><a href="#cb8-74" tabindex="-1"></a><span class="co">#&gt;  [54,] 4.132947</span></span>
<span id="cb8-75"><a href="#cb8-75" tabindex="-1"></a><span class="co">#&gt;  [55,] 4.829742</span></span>
<span id="cb8-76"><a href="#cb8-76" tabindex="-1"></a><span class="co">#&gt;  [56,] 3.957492</span></span>
<span id="cb8-77"><a href="#cb8-77" tabindex="-1"></a><span class="co">#&gt;  [57,] 4.494851</span></span>
<span id="cb8-78"><a href="#cb8-78" tabindex="-1"></a><span class="co">#&gt;  [58,] 3.206373</span></span>
<span id="cb8-79"><a href="#cb8-79" tabindex="-1"></a><span class="co">#&gt;  [59,] 4.562629</span></span>
<span id="cb8-80"><a href="#cb8-80" tabindex="-1"></a><span class="co">#&gt;  [60,] 3.788480</span></span>
<span id="cb8-81"><a href="#cb8-81" tabindex="-1"></a><span class="co">#&gt;  [61,] 3.540295</span></span>
<span id="cb8-82"><a href="#cb8-82" tabindex="-1"></a><span class="co">#&gt;  [62,] 4.253333</span></span>
<span id="cb8-83"><a href="#cb8-83" tabindex="-1"></a><span class="co">#&gt;  [63,] 4.155008</span></span>
<span id="cb8-84"><a href="#cb8-84" tabindex="-1"></a><span class="co">#&gt;  [64,] 4.328748</span></span>
<span id="cb8-85"><a href="#cb8-85" tabindex="-1"></a><span class="co">#&gt;  [65,] 3.818178</span></span>
<span id="cb8-86"><a href="#cb8-86" tabindex="-1"></a><span class="co">#&gt;  [66,] 4.645681</span></span>
<span id="cb8-87"><a href="#cb8-87" tabindex="-1"></a><span class="co">#&gt;  [67,] 4.029998</span></span>
<span id="cb8-88"><a href="#cb8-88" tabindex="-1"></a><span class="co">#&gt;  [68,] 3.681772</span></span>
<span id="cb8-89"><a href="#cb8-89" tabindex="-1"></a><span class="co">#&gt;  [69,] 4.995622</span></span>
<span id="cb8-90"><a href="#cb8-90" tabindex="-1"></a><span class="co">#&gt;  [70,] 3.800965</span></span>
<span id="cb8-91"><a href="#cb8-91" tabindex="-1"></a><span class="co">#&gt;  [71,] 4.538629</span></span>
<span id="cb8-92"><a href="#cb8-92" tabindex="-1"></a><span class="co">#&gt;  [72,] 4.255273</span></span>
<span id="cb8-93"><a href="#cb8-93" tabindex="-1"></a><span class="co">#&gt;  [73,] 4.875459</span></span>
<span id="cb8-94"><a href="#cb8-94" tabindex="-1"></a><span class="co">#&gt;  [74,] 4.116928</span></span>
<span id="cb8-95"><a href="#cb8-95" tabindex="-1"></a><span class="co">#&gt;  [75,] 4.413739</span></span>
<span id="cb8-96"><a href="#cb8-96" tabindex="-1"></a><span class="co">#&gt;  [76,] 4.636105</span></span>
<span id="cb8-97"><a href="#cb8-97" tabindex="-1"></a><span class="co">#&gt;  [77,] 4.914733</span></span>
<span id="cb8-98"><a href="#cb8-98" tabindex="-1"></a><span class="co">#&gt;  [78,] 5.125584</span></span>
<span id="cb8-99"><a href="#cb8-99" tabindex="-1"></a><span class="co">#&gt;  [79,] 4.392648</span></span>
<span id="cb8-100"><a href="#cb8-100" tabindex="-1"></a><span class="co">#&gt;  [80,] 3.672196</span></span>
<span id="cb8-101"><a href="#cb8-101" tabindex="-1"></a><span class="co">#&gt;  [81,] 3.791389</span></span>
<span id="cb8-102"><a href="#cb8-102" tabindex="-1"></a><span class="co">#&gt;  [82,] 3.653044</span></span>
<span id="cb8-103"><a href="#cb8-103" tabindex="-1"></a><span class="co">#&gt;  [83,] 3.958462</span></span>
<span id="cb8-104"><a href="#cb8-104" tabindex="-1"></a><span class="co">#&gt;  [84,] 4.660730</span></span>
<span id="cb8-105"><a href="#cb8-105" tabindex="-1"></a><span class="co">#&gt;  [85,] 3.881108</span></span>
<span id="cb8-106"><a href="#cb8-106" tabindex="-1"></a><span class="co">#&gt;  [86,] 4.206647</span></span>
<span id="cb8-107"><a href="#cb8-107" tabindex="-1"></a><span class="co">#&gt;  [87,] 4.784025</span></span>
<span id="cb8-108"><a href="#cb8-108" tabindex="-1"></a><span class="co">#&gt;  [88,] 4.728508</span></span>
<span id="cb8-109"><a href="#cb8-109" tabindex="-1"></a><span class="co">#&gt;  [89,] 3.753309</span></span>
<span id="cb8-110"><a href="#cb8-110" tabindex="-1"></a><span class="co">#&gt;  [90,] 4.003209</span></span>
<span id="cb8-111"><a href="#cb8-111" tabindex="-1"></a><span class="co">#&gt;  [91,] 3.799995</span></span>
<span id="cb8-112"><a href="#cb8-112" tabindex="-1"></a><span class="co">#&gt;  [92,] 4.263879</span></span>
<span id="cb8-113"><a href="#cb8-113" tabindex="-1"></a><span class="co">#&gt;  [93,] 4.023331</span></span>
<span id="cb8-114"><a href="#cb8-114" tabindex="-1"></a><span class="co">#&gt;  [94,] 3.345688</span></span>
<span id="cb8-115"><a href="#cb8-115" tabindex="-1"></a><span class="co">#&gt;  [95,] 3.947916</span></span>
<span id="cb8-116"><a href="#cb8-116" tabindex="-1"></a><span class="co">#&gt;  [96,] 3.689409</span></span>
<span id="cb8-117"><a href="#cb8-117" tabindex="-1"></a><span class="co">#&gt;  [97,] 3.892623</span></span>
<span id="cb8-118"><a href="#cb8-118" tabindex="-1"></a><span class="co">#&gt;  [98,] 4.264849</span></span>
<span id="cb8-119"><a href="#cb8-119" tabindex="-1"></a><span class="co">#&gt;  [99,] 3.428739</span></span>
<span id="cb8-120"><a href="#cb8-120" tabindex="-1"></a><span class="co">#&gt; [100,] 3.957492</span></span>
<span id="cb8-121"><a href="#cb8-121" tabindex="-1"></a><span class="co">#&gt; [101,] 5.739953</span></span>
<span id="cb8-122"><a href="#cb8-122" tabindex="-1"></a><span class="co">#&gt; [102,] 4.926874</span></span>
<span id="cb8-123"><a href="#cb8-123" tabindex="-1"></a><span class="co">#&gt; [103,] 5.976743</span></span>
<span id="cb8-124"><a href="#cb8-124" tabindex="-1"></a><span class="co">#&gt; [104,] 5.031017</span></span>
<span id="cb8-125"><a href="#cb8-125" tabindex="-1"></a><span class="co">#&gt; [105,] 5.668417</span></span>
<span id="cb8-126"><a href="#cb8-126" tabindex="-1"></a><span class="co">#&gt; [106,] 6.348969</span></span>
<span id="cb8-127"><a href="#cb8-127" tabindex="-1"></a><span class="co">#&gt; [107,] 4.109917</span></span>
<span id="cb8-128"><a href="#cb8-128" tabindex="-1"></a><span class="co">#&gt; [108,] 5.775468</span></span>
<span id="cb8-129"><a href="#cb8-129" tabindex="-1"></a><span class="co">#&gt; [109,] 5.588274</span></span>
<span id="cb8-130"><a href="#cb8-130" tabindex="-1"></a><span class="co">#&gt; [110,] 6.215352</span></span>
<span id="cb8-131"><a href="#cb8-131" tabindex="-1"></a><span class="co">#&gt; [111,] 5.261989</span></span>
<span id="cb8-132"><a href="#cb8-132" tabindex="-1"></a><span class="co">#&gt; [112,] 5.373545</span></span>
<span id="cb8-133"><a href="#cb8-133" tabindex="-1"></a><span class="co">#&gt; [113,] 5.753407</span></span>
<span id="cb8-134"><a href="#cb8-134" tabindex="-1"></a><span class="co">#&gt; [114,] 5.120512</span></span>
<span id="cb8-135"><a href="#cb8-135" tabindex="-1"></a><span class="co">#&gt; [115,] 5.553728</span></span>
<span id="cb8-136"><a href="#cb8-136" tabindex="-1"></a><span class="co">#&gt; [116,] 5.602578</span></span>
<span id="cb8-137"><a href="#cb8-137" tabindex="-1"></a><span class="co">#&gt; [117,] 5.115038</span></span>
<span id="cb8-138"><a href="#cb8-138" tabindex="-1"></a><span class="co">#&gt; [118,] 6.042806</span></span>
<span id="cb8-139"><a href="#cb8-139" tabindex="-1"></a><span class="co">#&gt; [119,] 6.959579</span></span>
<span id="cb8-140"><a href="#cb8-140" tabindex="-1"></a><span class="co">#&gt; [120,] 4.846731</span></span>
<span id="cb8-141"><a href="#cb8-141" tabindex="-1"></a><span class="co">#&gt; [121,] 5.974804</span></span>
<span id="cb8-142"><a href="#cb8-142" tabindex="-1"></a><span class="co">#&gt; [122,] 4.851459</span></span>
<span id="cb8-143"><a href="#cb8-143" tabindex="-1"></a><span class="co">#&gt; [123,] 6.414807</span></span>
<span id="cb8-144"><a href="#cb8-144" tabindex="-1"></a><span class="co">#&gt; [124,] 5.160755</span></span>
<span id="cb8-145"><a href="#cb8-145" tabindex="-1"></a><span class="co">#&gt; [125,] 5.484355</span></span>
<span id="cb8-146"><a href="#cb8-146" tabindex="-1"></a><span class="co">#&gt; [126,] 5.506416</span></span>
<span id="cb8-147"><a href="#cb8-147" tabindex="-1"></a><span class="co">#&gt; [127,] 5.021441</span></span>
<span id="cb8-148"><a href="#cb8-148" tabindex="-1"></a><span class="co">#&gt; [128,] 4.817257</span></span>
<span id="cb8-149"><a href="#cb8-149" tabindex="-1"></a><span class="co">#&gt; [129,] 5.585365</span></span>
<span id="cb8-150"><a href="#cb8-150" tabindex="-1"></a><span class="co">#&gt; [130,] 5.359465</span></span>
<span id="cb8-151"><a href="#cb8-151" tabindex="-1"></a><span class="co">#&gt; [131,] 6.053127</span></span>
<span id="cb8-152"><a href="#cb8-152" tabindex="-1"></a><span class="co">#&gt; [132,] 5.915007</span></span>
<span id="cb8-153"><a href="#cb8-153" tabindex="-1"></a><span class="co">#&gt; [133,] 5.723710</span></span>
<span id="cb8-154"><a href="#cb8-154" tabindex="-1"></a><span class="co">#&gt; [134,] 4.680852</span></span>
<span id="cb8-155"><a href="#cb8-155" tabindex="-1"></a><span class="co">#&gt; [135,] 4.523355</span></span>
<span id="cb8-156"><a href="#cb8-156" tabindex="-1"></a><span class="co">#&gt; [136,] 6.700103</span></span>
<span id="cb8-157"><a href="#cb8-157" tabindex="-1"></a><span class="co">#&gt; [137,] 5.536739</span></span>
<span id="cb8-158"><a href="#cb8-158" tabindex="-1"></a><span class="co">#&gt; [138,] 4.975724</span></span>
<span id="cb8-159"><a href="#cb8-159" tabindex="-1"></a><span class="co">#&gt; [139,] 4.742812</span></span>
<span id="cb8-160"><a href="#cb8-160" tabindex="-1"></a><span class="co">#&gt; [140,] 5.762983</span></span>
<span id="cb8-161"><a href="#cb8-161" tabindex="-1"></a><span class="co">#&gt; [141,] 6.029127</span></span>
<span id="cb8-162"><a href="#cb8-162" tabindex="-1"></a><span class="co">#&gt; [142,] 6.039673</span></span>
<span id="cb8-163"><a href="#cb8-163" tabindex="-1"></a><span class="co">#&gt; [143,] 4.926874</span></span>
<span id="cb8-164"><a href="#cb8-164" tabindex="-1"></a><span class="co">#&gt; [144,] 5.900358</span></span>
<span id="cb8-165"><a href="#cb8-165" tabindex="-1"></a><span class="co">#&gt; [145,] 6.037733</span></span>
<span id="cb8-166"><a href="#cb8-166" tabindex="-1"></a><span class="co">#&gt; [146,] 5.955651</span></span>
<span id="cb8-167"><a href="#cb8-167" tabindex="-1"></a><span class="co">#&gt; [147,] 5.428838</span></span>
<span id="cb8-168"><a href="#cb8-168" tabindex="-1"></a><span class="co">#&gt; [148,] 5.391727</span></span>
<span id="cb8-169"><a href="#cb8-169" tabindex="-1"></a><span class="co">#&gt; [149,] 5.323949</span></span>
<span id="cb8-170"><a href="#cb8-170" tabindex="-1"></a><span class="co">#&gt; [150,] 4.668367</span></span>
<span id="cb8-171"><a href="#cb8-171" tabindex="-1"></a><span class="co"># print(ensemble_results$model_details) # you can uncomment this line of code and run it</span></span></code></pre></div>
</div>
</div>
<div id="binary-tutorial" class="section level1">
<h1>Binary Tutorial</h1>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>#This tutorial provides a step-by-step guide on fitting a binomial
model using the dataset <code>mtcars</code>. It demonstrates how to
prepare the data, build a logistic regression model, lasso model, ridge
model, elastic net model, random forest model, prediction, and ensemble
model for binary predictors.</p>
</div>
<div id="dataset" class="section level2">
<h2>Dataset</h2>
<p>#The tutorial utilizes the <code>mtcars</code> dataset, which is
included in the R base package. This dataset contains information about
various car models.</p>
</div>
<div id="comparison-of-results-between-custom-logistics-model-and-r-built-in-model" class="section level2">
<h2>Comparison of results between custom logistics model and r built-in
model</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># 1. **Load the dataset**: First, load the `mtcars` dataset into your R environment.</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">data</span>(mtcars) </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> mtcars[, <span class="fu">c</span>(<span class="st">&quot;hp&quot;</span>, <span class="st">&quot;wt&quot;</span>)] <span class="co"># Predictor variables </span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mtcars<span class="sc">$</span>am <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># Response variable (binary)</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>y</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt;  [1] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 1 1 1 1 1</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>my_model_coefficients <span class="ot">&lt;-</span> <span class="fu">fit_logistic_model</span>(y,X)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="fu">print</span>(my_model_coefficients<span class="sc">$</span>summary)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt;             Estimate   StdError    zValue         Prz</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; Intercept 18.8662987 7.44355843  2.534581 0.011258203</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; hp         0.0362556 0.01773415  2.044394 0.040914654</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; wt        -8.0834752 3.06867528 -2.634190 0.008433816</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co"># Built-in Logistic Regression Model</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>my_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> hp<span class="sc">+</span>wt, <span class="at">data =</span> mtcars, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(my_model))</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; glm(formula = y ~ hp + wt, family = binomial(link = &quot;logit&quot;), </span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt;     data = mtcars)</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)   </span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; (Intercept) 18.86630    7.44356   2.535  0.01126 * </span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; hp           0.03626    0.01773   2.044  0.04091 * </span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; wt          -8.08348    3.06868  -2.634  0.00843 **</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 43.230  on 31  degrees of freedom</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 10.059  on 29  degrees of freedom</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt; AIC: 16.059</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 8</span></span></code></pre></div>
</div>
<div id="ridge-model" class="section level2">
<h2>Ridge Model</h2>
<p>This example demonstrates how to fit a Ridge regression model for a
binomial outcome using the <code>mtcars</code> dataset. The Ridge
regression is a technique used for handling multicollinearity in linear
regression models.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#Example for Binomial model</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> mtcars[, <span class="fu">c</span>(<span class="st">&quot;hp&quot;</span>, <span class="st">&quot;wt&quot;</span>)]</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mtcars<span class="sc">$</span>am <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># Converting &#39;am&#39; to a binary outcome</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>result_ridge_binomial <span class="ot">&lt;-</span> <span class="fu">fit_ridge_model</span>(y, X, <span class="at">model_type =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">add_intercept =</span> <span class="cn">TRUE</span>, <span class="at">bagging =</span> <span class="cn">TRUE</span>, <span class="at">R =</span> <span class="dv">50</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; Warning in .Ops.recycle.ind(e2, len = l1): longer object length</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt;  is not a multiple of shorter object length</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="fu">print</span>(result_ridge_binomial)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; $coefficients</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; [1]  5.877115899  0.006187161 -2.333778263</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; $se_coefficients</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.166000925 0.001012321 0.056837384</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; $t_values</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt; [1]  35.404115   6.111856 -41.060621</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt; $p_values</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co">#&gt; [1] 2.040886e-25 1.172413e-06 3.009505e-27</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; $predictions</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co">#&gt;  [1] 0.3495867 0.4459256 0.4033144 0.4157343 0.3460799 0.4593661 0.4062963</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="co">#&gt;  [8] 0.3620835 0.3554819 0.4071882 0.4106186 0.3858851 0.4160086 0.3563715</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="co">#&gt; [15] 0.4446434 0.4772147 0.4348000 0.3443786 0.4307013 0.4414173 0.4036028</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co">#&gt; [22] 0.3781091 0.3778454 0.3876409 0.4162916 0.4036984 0.4218137 0.4811821</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co">#&gt; [29] 0.3725747 0.4013897 0.3796618 0.3630938</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a><span class="co">#&gt; $variable_importance</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a><span class="co">#&gt; 3 x 1 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co">#&gt;             s0</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a><span class="co">#&gt; (Intercept)  1</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a><span class="co">#&gt; hp           1</span></span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a><span class="co">#&gt; wt           1</span></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a><span class="co">#&gt; $model_type</span></span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a><span class="co">#&gt; [1] &quot;binomial&quot;</span></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a><span class="co">#&gt; $names</span></span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Intercept&quot; &quot;hp&quot;        &quot;wt&quot;</span></span></code></pre></div>
</div>
<div id="lasso-model" class="section level2">
<h2>Lasso Model</h2>
<p>This example demonstrates how to fit a Lasso regression model for a
binomial outcome using the <code>mtcars</code> dataset. Lasso regression
is a technique used for feature selection and regularization in linear
regression models.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> mtcars[, <span class="fu">c</span>(<span class="st">&quot;hp&quot;</span>, <span class="st">&quot;wt&quot;</span>)]</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mtcars<span class="sc">$</span>am <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># Converting &#39;am&#39; to a binary outcome</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>result_lasso_binomial <span class="ot">&lt;-</span> <span class="fu">fit_lasso_model</span>(y, X, <span class="at">model_type =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">add_intercept =</span> <span class="cn">TRUE</span>, <span class="at">bagging =</span> <span class="cn">TRUE</span>, <span class="at">R =</span> <span class="dv">50</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; Warning in .Ops.recycle.ind(e2, len = l1): longer object length</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt;  is not a multiple of shorter object length</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; Warning in lognet(xd, is.sparse, ix, jx, y, weights, offset, alpha, nobs, : one</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; multinomial or binomial class has fewer than 8 observations; dangerous ground</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="fu">print</span>(result_lasso_binomial)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; $coefficients</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; [1] 13.74071671  0.01879827 -5.47860815</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; $se_coefficients</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; [1] 0.617418688 0.001268556 0.188906025</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; $t_values</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; [1]  22.25510  14.81863 -29.00177</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; $p_values</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; [1] 8.902763e-20 4.595316e-15 5.686927e-23</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; $predictions</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt;  [1] 0.4241862 0.4276518 0.3042118 0.4472897 0.3919068 0.4768364 0.3904968</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt;  [8] 0.3831932 0.4089355 0.4284864 0.4349646 0.4422270 0.3819817 0.5064968</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; [15] 0.4926967 0.3201000 0.3657128 0.4212407 0.3636884 0.4366880 0.3614406</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; [22] 0.4756256 0.5603935 0.4500673 0.4783724 0.3925102 0.4485354 0.3742366</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt; [29] 0.4639640 0.3926941 0.4210928 0.4520763</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; $variable_importance</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; 3 x 1 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt;               s0</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt; (Intercept) 1.00</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt; hp          0.88</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt; wt          1.00</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt; $names</span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Intercept&quot; &quot;hp&quot;        &quot;wt&quot;       </span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt; $model_type</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt; [1] &quot;binomial&quot;</span></span></code></pre></div>
</div>
<div id="elastic-net-model" class="section level2">
<h2>Elastic Net Model</h2>
<p>This example demonstrates how to fit an Elastic Net regression model
for a binomial outcome using the <code>mtcars</code> dataset. Elastic
Net regression combines the penalties of Lasso and Ridge regression,
offering a balance between feature selection and regularization.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Example for Binomial model</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> mtcars[, <span class="fu">c</span>(<span class="st">&quot;hp&quot;</span>, <span class="st">&quot;wt&quot;</span>)]</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mtcars<span class="sc">$</span>am <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># Converting &#39;am&#39; to a binary outcome</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>result_elastic_net_binomial <span class="ot">&lt;-</span> <span class="fu">fit_elastic_net_model</span>(y, X, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">model_type =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">add_intercept =</span> <span class="cn">TRUE</span>, <span class="at">bagging =</span> <span class="cn">TRUE</span>, <span class="at">R =</span> <span class="dv">50</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; Warning in .Ops.recycle.ind(e2, len = l1): longer object length</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt;  is not a multiple of shorter object length</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; Warning in lognet(xd, is.sparse, ix, jx, y, weights, offset, alpha, nobs, : one</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; multinomial or binomial class has fewer than 8 observations; dangerous ground</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="fu">print</span>(result_elastic_net_binomial)</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; $coefficients</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; [1] 13.18627804  0.02085567 -5.48421226</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; $se_coefficients</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; [1] 0.557366712 0.001342668 0.169099960</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; $t_values</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; [1]  23.65817  15.53300 -32.43178</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; $p_values</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; [1] 1.653688e-20 1.360133e-15 2.442668e-24</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; $predictions</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt;  [1] 0.5177097 0.4415035 0.4653601 0.4292850 0.3472186 0.4503342 0.4025644</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt;  [8] 0.3956721 0.3176185 0.3603931 0.3741967 0.4153144 0.3999417 0.3142111</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt; [15] 0.3427477 0.3743275 0.3907157 0.4173579 0.4436872 0.3007675 0.3481976</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co">#&gt; [22] 0.4329548 0.3243023 0.4016816 0.3683460 0.3500426 0.3646008 0.3949055</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt; [29] 0.3471625 0.3928206 0.4311331 0.4029263</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt; $variable_importance</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co">#&gt; 3 x 1 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a><span class="co">#&gt;               s0</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a><span class="co">#&gt; (Intercept) 1.00</span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a><span class="co">#&gt; hp          0.96</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co">#&gt; wt          1.00</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="co">#&gt; $names</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Intercept&quot; &quot;hp&quot;        &quot;wt&quot;       </span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="co">#&gt; $model_type</span></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a><span class="co">#&gt; [1] &quot;binomial&quot;</span></span></code></pre></div>
</div>
<div id="random-forest-model" class="section level2">
<h2>Random Forest Model</h2>
<p>This example demonstrates how to fit a Random Forest model for a
binomial outcome using the <code>mtcars</code> dataset. Random Forest is
an ensemble learning method that constructs multiple decision trees
during training and outputs the mode of the classes (classification) or
the mean prediction (regression) of the individual trees.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> mtcars[, <span class="fu">c</span>(<span class="st">&quot;hp&quot;</span>, <span class="st">&quot;wt&quot;</span>)]</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mtcars<span class="sc">$</span>am <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>result_rf_binomial <span class="ot">&lt;-</span> <span class="fu">fit_random_forest_model</span>(y, X, <span class="at">model_type =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">print</span>(result_rf_binomial)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; $model_type</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; [1] &quot;random_forest&quot;</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; $model</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt;  randomForest(x = X, y = y, type = &quot;classification&quot;) </span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt;                Type of random forest: classification</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt;                      Number of trees: 500</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">#&gt; No. of variables tried at each split: 1</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt;         OOB estimate of  error rate: 12.5%</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; Confusion matrix:</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt;    0  1 class.error</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt; 0 17  2   0.1052632</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co">#&gt; 1  2 11   0.1538462</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co">#&gt; $predictions</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="co">#&gt;           Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive </span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="co">#&gt;               0.956               0.978               0.888               0.134 </span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt;   Hornet Sportabout             Valiant          Duster 360           Merc 240D </span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt;               0.012               0.036               0.092               0.182 </span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co">#&gt;            Merc 230            Merc 280           Merc 280C          Merc 450SE </span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co">#&gt;               0.148               0.024               0.024               0.000 </span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="co">#&gt;          Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental </span></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="co">#&gt;               0.000               0.000               0.000               0.000 </span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="co">#&gt;   Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla </span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="co">#&gt;               0.002               0.992               0.958               0.996 </span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a><span class="co">#&gt;       Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 </span></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a><span class="co">#&gt;               0.330               0.022               0.002               0.016 </span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a><span class="co">#&gt;    Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa </span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a><span class="co">#&gt;               0.010               0.996               0.940               0.942 </span></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a><span class="co">#&gt;      Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E </span></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a><span class="co">#&gt;               0.654               0.870               0.708               0.982 </span></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a><span class="co">#&gt; $names</span></span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a><span class="co">#&gt; [1] &quot;hp&quot; &quot;wt&quot;</span></span></code></pre></div>
</div>
<div id="ensemble-model" class="section level2">
<h2>Ensemble Model</h2>
<p>This example demonstrates how to create an ensemble model for a
binomial outcome using the <code>mtcars</code> dataset. Ensemble models
combine predictions from multiple individual models to improve
predictive performance and robustness.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co">#Assuming `fit_linear_model` and `fit_random_forest_model` are used.</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> mtcars[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(mtcars) <span class="sc">==</span> <span class="st">&quot;mpg&quot;</span>)]</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>am <span class="co"># For gaussian; use a binary response for &#39;binomial&#39;</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;fit_logistic_model&quot;</span>, <span class="st">&quot;fit_random_forest_model&quot;</span>,<span class="st">&quot;fit_lasso_model&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">ensemble_model_fitting</span>(y, X, <span class="at">model_type =</span> <span class="st">&#39;binomial&#39;</span>, <span class="at">model_list =</span> model_list)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;fit_logistic_model&quot;</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; [1] &quot;fit_random_forest_model&quot;</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;fit_lasso_model&quot;</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="fu">print</span>(results<span class="sc">$</span>combined_predictions)</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; $probabilities</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; 32 x 1 Matrix of class &quot;dgeMatrix&quot;</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt;                             [,1]</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; Mazda RX4           0.9923985333</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; Mazda RX4 Wag       0.9897318666</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; Datsun 710          0.9917318666</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; Hornet 4 Drive      0.0035168082</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; Hornet Sportabout   0.0028501415</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; Valiant             0.0008501415</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; Duster 360          0.0061834749</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; Merc 240D           0.0328501415</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; Merc 230            0.0375168082</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; Merc 280            0.0161834749</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; Merc 280C           0.0141834749</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; Merc 450SE          0.0001834749</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt; Merc 450SL          0.0001834749</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt; Merc 450SLC         0.0001834749</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt; Cadillac Fleetwood  0.0001834749</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt; Lincoln Continental 0.0001834749</span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="co">#&gt; Chrysler Imperial   0.0001834749</span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt; Fiat 128            0.9963985333</span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt; Honda Civic         0.9983985333</span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt; Toyota Corolla      0.9923985333</span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt; Toyota Corona       0.0428501415</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt; Dodge Challenger    0.0035168082</span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co">#&gt; AMC Javelin         0.0001834749</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co">#&gt; Camaro Z28          0.0115168082</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a><span class="co">#&gt; Pontiac Firebird    0.0008501415</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a><span class="co">#&gt; Fiat X1-9           0.9990651999</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a><span class="co">#&gt; Porsche 914-2       0.9977318666</span></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="co">#&gt; Lotus Europa        0.9910651999</span></span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a><span class="co">#&gt; Ford Pantera L      0.9650651999</span></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="co">#&gt; Ferrari Dino        0.9810651999</span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a><span class="co">#&gt; Maserati Bora       0.9497318666</span></span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a><span class="co">#&gt; Volvo 142E          0.9910651999</span></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a><span class="co">#&gt; $final_classes</span></span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a><span class="co">#&gt;  [1] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 1 1 1 1 1</span></span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a></span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a><span class="co"># To view individual model details and predictions:</span></span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a><span class="co"># print(results$model_details) # you can uncomment this line of code and run it</span></span></code></pre></div>
</div>
<div id="predict-function" class="section level2">
<h2>Predict Function</h2>
<p>Once your model is fit using desired technique, you may want to test
your model on new datasets and see the generalizability. Use the predict
function to do so.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> mtcars[, <span class="fu">c</span>(<span class="st">&quot;hp&quot;</span>, <span class="st">&quot;wt&quot;</span>)]</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mtcars<span class="sc">$</span>am <span class="sc">==</span> <span class="dv">1</span>)  <span class="co"># Response variable (binary)</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>num_rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mtcars)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>num_train <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fl">0.7</span> <span class="sc">*</span> num_rows)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>num_rows, num_train)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> X[train_indices, ]</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>training_labels <span class="ot">&lt;-</span> y[train_indices]</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>testing_data <span class="ot">&lt;-</span> X[<span class="sc">-</span>train_indices, ]</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>testing_labels <span class="ot">&lt;-</span> y[<span class="sc">-</span>train_indices]</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> testing_data</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>model<span class="ot">&lt;-</span> <span class="fu">fit_logistic_model</span>(y,X)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="fu">predict_model</span>(model, newdata, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">threshold =</span> <span class="fl">0.5</span>)</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt;                  [,1]</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; Mazda RX4 Wag       0</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; Merc 230            0</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; Merc 450SL          0</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; Fiat 128            1</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; Dodge Challenger    0</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; AMC Javelin         0</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; Camaro Z28          0</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; Pontiac Firebird    0</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; Porsche 914-2       1</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; Lotus Europa        1</span></span></code></pre></div>
</div>
</div>
<div id="special-data-set-where-p-n" class="section level1">
<h1>Special data set where p &gt;&gt; n</h1>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Set the seed for reproducibility</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># Define the number of observations and predictors</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>num_observations <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>num_predictors <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co"># Generate a random dataset</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co"># Each row corresponds to an observation</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co"># Each column corresponds to a predictor</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(num_observations <span class="sc">*</span> num_predictors), </span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>               <span class="at">nrow =</span> num_observations, </span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>               <span class="at">ncol =</span> num_predictors)</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co"># Convert matrix to data frame</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(X)</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co"># Label the features</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>feature_labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Feature&quot;</span>, <span class="dv">1</span><span class="sc">:</span>num_predictors, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="fu">names</span>(X) <span class="ot">&lt;-</span> feature_labels</span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(num_observations)</span></code></pre></div>
<div id="selecting-most-important-features" class="section level2">
<h2>Selecting most important features</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Define the number of top predictors to select</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co"># Call the select_informative_predictors function</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">select_informative_predictors</span>(X,K)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>result<span class="sc">$</span>top_predictors_data</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt;       Feature88   Feature86    Feature29   Feature39    Feature38   Feature73</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; 1   0.038534227  0.19819556 -1.086118241  1.53732754 -2.629325442 -0.21362309</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; 2  -0.127406724  0.31056031 -0.665302796 -0.45577106  1.469812282  1.19787606</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt; 3   1.106133390  0.52632360  0.714848356 -0.03265845  2.273472913  0.23180313</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; 4   2.415056393  0.71104652 -0.431661100  1.63675735 -0.455033540 -0.50284145</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; 5  -0.085437750  0.41031061  0.227614940 -0.32904197  0.761102487  0.63045713</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; 6   1.177985591  0.30139893  1.294945796 -2.60403817 -0.007502784  0.95729753</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; 7   0.486182865 -0.09543010  0.578334940  0.51398379  1.474313800 -0.07448286</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; 8  -0.076045978  0.44876031  1.364672781 -0.88646801  0.554143933 -2.67816441</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; 9  -1.920885050 -1.26924504 -1.701579803 -0.99853841  0.203663965  1.63616439</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; 10 -0.967552746  0.65427019 -0.280676280  1.42081681 -1.799136452 -0.75063055</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; 11 -0.556743932 -0.53490937  0.065068019  2.44799801  1.082955681 -0.34914391</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; 12 -1.110207184  2.33752882  0.578589292 -1.03978254 -0.350853615  1.61863074</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; 13 -1.161249940 -0.59633806 -1.169206622  1.03102518 -1.403490085 -1.89803989</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; 14 -0.412925485 -2.88762983  0.806184855 -0.09414784 -0.201796665 -1.10654436</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; 15  0.951889434  1.37208530  0.307390076  0.14180746 -0.126778160 -0.74945071</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; 16 -0.920180527 -0.59865238  0.263806014  1.22223670  1.059206873 -1.31288137</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; 17  0.118175118  0.59295092  0.508484792  0.21367452 -1.167396032  1.10328832</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; 18 -0.202992795  0.22574207 -0.116358440 -0.85136535 -0.557643627  1.26449613</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt; 19  0.793099799  1.09631206  0.925546098 -0.47040887  1.488119928  0.50087613</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt; 20  0.038436841 -0.90326602  0.648229774  0.68613526  1.358665769 -0.43940583</span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a><span class="co">#&gt; 21 -0.168162992 -1.18906159 -0.150209374 -2.33594733  1.163214544 -0.42367998</span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="co">#&gt; 22 -0.584189409  1.06496900  1.040377019  1.09524438  1.661523945 -0.56807307</span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co">#&gt; 23  0.891898667 -0.95856747  0.292558685 -1.56715010  0.204030980 -0.52470637</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a><span class="co">#&gt; 24  1.139333076 -1.53369412  0.668751399  0.02193106 -0.581883687  0.48282559</span></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a><span class="co">#&gt; 25  0.019442483  0.77796950 -0.594177642 -0.19035898  0.555204062  0.90926337</span></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="co">#&gt; 26  3.271782751 -0.06525828  1.580431837  1.29306949  1.058723126 -0.45657769</span></span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="co">#&gt; 27 -0.002993212  2.27820422 -0.003988944  0.18884932  2.413633271  0.31899040</span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a><span class="co">#&gt; 28  2.923823950  0.34360962  0.847842769  0.10193913 -1.964982333 -2.38579275</span></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a><span class="co">#&gt; 29 -0.133879522 -0.35309274 -0.100116526  0.69813581  0.273235703  0.07583697</span></span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a><span class="co">#&gt; 30 -1.570707062 -0.62718455 -0.279629907 -0.82701456  0.654794583 -0.87844186</span></span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a><span class="co">#&gt; 31 -1.424766580  1.68460867  0.784438245 -0.19589886 -0.054598655  1.09853318</span></span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a><span class="co">#&gt; 32 -0.871469943 -1.21492788 -1.584616645  1.17758441 -1.557822248  1.18582441</span></span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a><span class="co">#&gt; 33  1.478407982  0.61696205  0.478366148  0.68347362  0.741500892 -2.19649538</span></span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a><span class="co">#&gt; 34  1.703323302  0.56168002  0.393566373 -1.27549671 -0.779085741  0.92231752</span></span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a><span class="co">#&gt; 35  0.397608593 -0.57280593 -2.695329369  0.63795637  0.505861499 -0.56572839</span></span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a><span class="co">#&gt; 36  0.308495293  1.53571788  0.368377329 -1.37758962  0.907551706 -0.16394102</span></span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a><span class="co">#&gt; 37 -0.536955293 -0.74765546 -2.168417747 -0.59831080  1.283957010  0.89850083</span></span>
<span id="cb17-44"><a href="#cb17-44" tabindex="-1"></a><span class="co">#&gt; 38 -0.676675596 -0.01947186  0.659804377  1.21092038 -1.557863797  0.68916732</span></span>
<span id="cb17-45"><a href="#cb17-45" tabindex="-1"></a><span class="co">#&gt; 39 -0.717903102  0.38762840 -0.453913733 -2.25104518  1.081741848 -0.81902325</span></span>
<span id="cb17-46"><a href="#cb17-46" tabindex="-1"></a><span class="co">#&gt; 40 -0.870549995  2.32312597 -0.694936825 -1.77901419 -0.756981357  0.32006676</span></span>
<span id="cb17-47"><a href="#cb17-47" tabindex="-1"></a><span class="co">#&gt; 41 -0.539922450  0.61515224 -0.006846303  1.30137267 -1.289019474 -0.46707523</span></span>
<span id="cb17-48"><a href="#cb17-48" tabindex="-1"></a><span class="co">#&gt; 42 -0.622689768  1.73154803  1.373052045 -0.81479278  1.314320666  1.25185534</span></span>
<span id="cb17-49"><a href="#cb17-49" tabindex="-1"></a><span class="co">#&gt; 43  0.528537450 -0.72856262 -0.635323077  1.24370702  1.146259973 -1.57147259</span></span>
<span id="cb17-50"><a href="#cb17-50" tabindex="-1"></a><span class="co">#&gt; 44  0.770818672 -1.74544031  0.558103294 -0.16825020 -0.242583268  0.81975445</span></span>
<span id="cb17-51"><a href="#cb17-51" tabindex="-1"></a><span class="co">#&gt; 45  1.603180754  0.88935679  0.341157868  0.42777568  0.759540706  1.39109609</span></span>
<span id="cb17-52"><a href="#cb17-52" tabindex="-1"></a><span class="co">#&gt; 46 -2.448621354 -1.62846900 -1.179518629  0.81327889 -0.860325741 -2.60952501</span></span>
<span id="cb17-53"><a href="#cb17-53" tabindex="-1"></a><span class="co">#&gt; 47  0.495119682 -1.34221036 -1.741022017 -0.65121187 -0.151031579  0.64774660</span></span>
<span id="cb17-54"><a href="#cb17-54" tabindex="-1"></a><span class="co">#&gt; 48 -0.318468478  0.61077020 -1.992585771 -0.30459092 -0.093723234 -0.36297958</span></span>
<span id="cb17-55"><a href="#cb17-55" tabindex="-1"></a><span class="co">#&gt; 49 -0.266390603 -0.05577663  0.551274211 -0.41509717 -0.280740055  0.11022175</span></span>
<span id="cb17-56"><a href="#cb17-56" tabindex="-1"></a><span class="co">#&gt; 50 -1.641704110  0.84701928 -0.034742062  2.81608428  0.734098736 -0.27007415</span></span>
<span id="cb17-57"><a href="#cb17-57" tabindex="-1"></a><span class="co">#&gt;      Feature60   Feature14    Feature5   Feature66</span></span>
<span id="cb17-58"><a href="#cb17-58" tabindex="-1"></a><span class="co">#&gt; 1   0.24284395 -1.93850470  2.19881035  0.51981427</span></span>
<span id="cb17-59"><a href="#cb17-59" tabindex="-1"></a><span class="co">#&gt; 2   1.96963413  0.10719041  1.31241298 -0.07765504</span></span>
<span id="cb17-60"><a href="#cb17-60" tabindex="-1"></a><span class="co">#&gt; 3  -0.53003831  0.60877901 -0.26514506  0.82503876</span></span>
<span id="cb17-61"><a href="#cb17-61" tabindex="-1"></a><span class="co">#&gt; 4   1.29100898 -1.45082431  0.54319406  1.12056903</span></span>
<span id="cb17-62"><a href="#cb17-62" tabindex="-1"></a><span class="co">#&gt; 5  -0.60707820  0.48062560 -0.41433995 -0.12216360</span></span>
<span id="cb17-63"><a href="#cb17-63" tabindex="-1"></a><span class="co">#&gt; 6   1.71013968 -0.82817427 -0.47624689  1.94533708</span></span>
<span id="cb17-64"><a href="#cb17-64" tabindex="-1"></a><span class="co">#&gt; 7  -0.66624738  1.02025301 -0.78860284  0.98836270</span></span>
<span id="cb17-65"><a href="#cb17-65" tabindex="-1"></a><span class="co">#&gt; 8  -0.81437228  0.53848203 -0.59461727  1.22438538</span></span>
<span id="cb17-66"><a href="#cb17-66" tabindex="-1"></a><span class="co">#&gt; 9   1.03640262  0.76905229  1.65090747 -0.31511761</span></span>
<span id="cb17-67"><a href="#cb17-67" tabindex="-1"></a><span class="co">#&gt; 10  0.96493153  0.12071933 -0.05402813 -0.13112286</span></span>
<span id="cb17-68"><a href="#cb17-68" tabindex="-1"></a><span class="co">#&gt; 11  0.55171084  0.86364843  0.11924524 -0.92258542</span></span>
<span id="cb17-69"><a href="#cb17-69" tabindex="-1"></a><span class="co">#&gt; 12  0.27318853  1.38051453  0.24368743  0.40736909</span></span>
<span id="cb17-70"><a href="#cb17-70" tabindex="-1"></a><span class="co">#&gt; 13  0.24185980  1.96624802  1.23247588  0.26401143</span></span>
<span id="cb17-71"><a href="#cb17-71" tabindex="-1"></a><span class="co">#&gt; 14  2.05476071 -0.02839505 -0.51606383  0.09128355</span></span>
<span id="cb17-72"><a href="#cb17-72" tabindex="-1"></a><span class="co">#&gt; 15 -1.43253450 -2.24905109 -0.99250715 -0.68068743</span></span>
<span id="cb17-73"><a href="#cb17-73" tabindex="-1"></a><span class="co">#&gt; 16 -0.98633632  0.03152600  1.67569693 -0.23196950</span></span>
<span id="cb17-74"><a href="#cb17-74" tabindex="-1"></a><span class="co">#&gt; 17 -1.27914012  0.20556121 -0.44116322  1.98511178</span></span>
<span id="cb17-75"><a href="#cb17-75" tabindex="-1"></a><span class="co">#&gt; 18  0.96075549 -0.15534535 -0.72306597 -0.92915936</span></span>
<span id="cb17-76"><a href="#cb17-76" tabindex="-1"></a><span class="co">#&gt; 19 -0.24564194  0.56828862 -1.23627312 -0.40609023</span></span>
<span id="cb17-77"><a href="#cb17-77" tabindex="-1"></a><span class="co">#&gt; 20 -0.13000846  1.01067796 -1.28471572 -1.40343255</span></span>
<span id="cb17-78"><a href="#cb17-78" tabindex="-1"></a><span class="co">#&gt; 21  1.78330682 -0.51798243 -0.57397348 -1.24072907</span></span>
<span id="cb17-79"><a href="#cb17-79" tabindex="-1"></a><span class="co">#&gt; 22 -0.57902645 -0.29409533  0.61798582 -0.28676520</span></span>
<span id="cb17-80"><a href="#cb17-80" tabindex="-1"></a><span class="co">#&gt; 23  2.02279460  0.39784221  1.10984814 -0.39128730</span></span>
<span id="cb17-81"><a href="#cb17-81" tabindex="-1"></a><span class="co">#&gt; 24 -1.40944081 -0.55022374  0.70758835 -0.61690156</span></span>
<span id="cb17-82"><a href="#cb17-82" tabindex="-1"></a><span class="co">#&gt; 25  1.31783561  0.09126738 -0.36365730 -0.77384431</span></span>
<span id="cb17-83"><a href="#cb17-83" tabindex="-1"></a><span class="co">#&gt; 26  0.32312100 -1.96170760  0.05974994 -0.19662692</span></span>
<span id="cb17-84"><a href="#cb17-84" tabindex="-1"></a><span class="co">#&gt; 27 -0.38860052 -1.11989972 -0.70459646  1.13402054</span></span>
<span id="cb17-85"><a href="#cb17-85" tabindex="-1"></a><span class="co">#&gt; 28 -0.17283690 -1.32775548 -0.71721816 -0.35780119</span></span>
<span id="cb17-86"><a href="#cb17-86" tabindex="-1"></a><span class="co">#&gt; 29  1.33897467 -0.85362370  0.88465050 -1.28320386</span></span>
<span id="cb17-87"><a href="#cb17-87" tabindex="-1"></a><span class="co">#&gt; 30  1.70380587 -0.69330453 -1.01559258 -1.06905180</span></span>
<span id="cb17-88"><a href="#cb17-88" tabindex="-1"></a><span class="co">#&gt; 31 -1.67846782  0.38230514  1.95529397 -2.00434765</span></span>
<span id="cb17-89"><a href="#cb17-89" tabindex="-1"></a><span class="co">#&gt; 32  3.42109461  0.98211300 -0.09031959 -1.71051632</span></span>
<span id="cb17-90"><a href="#cb17-90" tabindex="-1"></a><span class="co">#&gt; 33  2.57794265 -0.72738353  0.21453883 -0.74742018</span></span>
<span id="cb17-91"><a href="#cb17-91" tabindex="-1"></a><span class="co">#&gt; 34 -0.52532183 -0.99683898 -0.73852770 -0.97641546</span></span>
<span id="cb17-92"><a href="#cb17-92" tabindex="-1"></a><span class="co">#&gt; 35 -0.06438191 -1.04168886 -0.57438869 -1.14902611</span></span>
<span id="cb17-93"><a href="#cb17-93" tabindex="-1"></a><span class="co">#&gt; 36 -0.66354736 -0.41458873 -1.31701613  1.98924365</span></span>
<span id="cb17-94"><a href="#cb17-94" tabindex="-1"></a><span class="co">#&gt; 37 -0.09300109 -0.23902907 -0.18292539  1.75113108</span></span>
<span id="cb17-95"><a href="#cb17-95" tabindex="-1"></a><span class="co">#&gt; 38  0.73985944  0.48361753  0.41898240  2.56440930</span></span>
<span id="cb17-96"><a href="#cb17-96" tabindex="-1"></a><span class="co">#&gt; 39  0.10336281 -0.32132484  0.32430434  0.77649590</span></span>
<span id="cb17-97"><a href="#cb17-97" tabindex="-1"></a><span class="co">#&gt; 40  0.19200700 -2.07848927 -0.78153649 -0.16124854</span></span>
<span id="cb17-98"><a href="#cb17-98" tabindex="-1"></a><span class="co">#&gt; 41  1.47880760 -0.09143428 -0.78862197 -1.04326069</span></span>
<span id="cb17-99"><a href="#cb17-99" tabindex="-1"></a><span class="co">#&gt; 42 -2.20386848  1.18718681 -0.50219872 -1.10076626</span></span>
<span id="cb17-100"><a href="#cb17-100" tabindex="-1"></a><span class="co">#&gt; 43 -0.49144305  1.19160127  1.49606067 -0.49687395</span></span>
<span id="cb17-101"><a href="#cb17-101" tabindex="-1"></a><span class="co">#&gt; 44  0.14441727 -0.78896322 -1.13730362  1.28052093</span></span>
<span id="cb17-102"><a href="#cb17-102" tabindex="-1"></a><span class="co">#&gt; 45 -0.78310064 -1.54777654 -0.17905159  0.66647056</span></span>
<span id="cb17-103"><a href="#cb17-103" tabindex="-1"></a><span class="co">#&gt; 46  1.06096624  2.45806049  1.90236182  0.88950020</span></span>
<span id="cb17-104"><a href="#cb17-104" tabindex="-1"></a><span class="co">#&gt; 47 -0.44550564 -0.16242194 -0.10097489 -0.18712143</span></span>
<span id="cb17-105"><a href="#cb17-105" tabindex="-1"></a><span class="co">#&gt; 48 -0.42918015 -0.09745125 -1.35984070 -1.55363634</span></span>
<span id="cb17-106"><a href="#cb17-106" tabindex="-1"></a><span class="co">#&gt; 49  1.18901180  0.42057419 -0.66476944  0.32640267</span></span>
<span id="cb17-107"><a href="#cb17-107" tabindex="-1"></a><span class="co">#&gt; 50  0.83429407 -1.61403946  0.48545998 -0.21461197</span></span>
<span id="cb17-108"><a href="#cb17-108" tabindex="-1"></a><span class="co"># Print the top K predictors and their scores</span></span>
<span id="cb17-109"><a href="#cb17-109" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Top Predictors:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb17-110"><a href="#cb17-110" tabindex="-1"></a><span class="co">#&gt; Top Predictors:</span></span>
<span id="cb17-111"><a href="#cb17-111" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>predictor_names)</span>
<span id="cb17-112"><a href="#cb17-112" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;Feature88&quot; &quot;Feature86&quot; &quot;Feature29&quot; &quot;Feature39&quot; &quot;Feature38&quot; &quot;Feature73&quot;</span></span>
<span id="cb17-113"><a href="#cb17-113" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;Feature60&quot; &quot;Feature14&quot; &quot;Feature5&quot;  &quot;Feature66&quot;</span></span>
<span id="cb17-114"><a href="#cb17-114" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Scores:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb17-115"><a href="#cb17-115" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-116"><a href="#cb17-116" tabindex="-1"></a><span class="co">#&gt; Scores:</span></span>
<span id="cb17-117"><a href="#cb17-117" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>scores)</span>
<span id="cb17-118"><a href="#cb17-118" tabindex="-1"></a><span class="co">#&gt;  [1] 0.2297506 0.2185309 0.2058841 0.2002281 0.1829796 0.1795003 0.1761163</span></span>
<span id="cb17-119"><a href="#cb17-119" tabindex="-1"></a><span class="co">#&gt;  [8] 0.1716030 0.1612844 0.1610676</span></span></code></pre></div>
</div>
<div id="fitting-models-after-selecting-most-important-features" class="section level2">
<h2>Fitting models after selecting most important features</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;fit_linear_model&quot;</span>, <span class="st">&quot;fit_ridge_model&quot;</span>, <span class="st">&quot;fit_random_forest_model&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>ensemble_fit <span class="ot">&lt;-</span> <span class="fu">ensemble_model_fitting</span>(y, result<span class="sc">$</span>top_predictors_data, <span class="at">model_type =</span> <span class="st">&quot;gaussian&quot;</span>, model_list)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;fit_linear_model&quot;</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; Matrix X is singular. Using SVD to compute coefficients.</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; [1] &quot;fit_ridge_model&quot;</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;fit_random_forest_model&quot;</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="fu">print</span>(ensemble_fit<span class="sc">$</span>combined_predictions)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; 50 x 1 Matrix of class &quot;dgeMatrix&quot;</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt;                 s1</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt;  [1,] -0.169630832</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.434489357</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt;  [3,] -0.086016663</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt;  [4,]  0.347637866</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt;  [5,]  0.142335289</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt;  [6,]  0.341590160</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.079348207</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.115927870</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt;  [9,] -0.125624909</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; [10,]  0.018711453</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; [11,] -0.286189882</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; [12,]  0.733379845</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; [13,]  0.184678709</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; [14,] -0.202570988</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; [15,] -0.471719782</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt; [16,] -0.209905994</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co">#&gt; [17,] -0.160992683</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="co">#&gt; [18,] -0.078025491</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt; [19,]  0.387337570</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="co">#&gt; [20,] -0.519455446</span></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="co">#&gt; [21,] -0.277329446</span></span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a><span class="co">#&gt; [22,] -0.169003002</span></span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a><span class="co">#&gt; [23,]  0.078173639</span></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a><span class="co">#&gt; [24,] -0.579254624</span></span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a><span class="co">#&gt; [25,]  0.112765559</span></span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a><span class="co">#&gt; [26,] -0.361525070</span></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a><span class="co">#&gt; [27,]  0.370866123</span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a><span class="co">#&gt; [28,] -0.035751845</span></span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a><span class="co">#&gt; [29,] -0.008659009</span></span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a><span class="co">#&gt; [30,] -0.391853426</span></span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a><span class="co">#&gt; [31,]  0.008117150</span></span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a><span class="co">#&gt; [32,]  0.133457435</span></span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a><span class="co">#&gt; [33,]  0.164518585</span></span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a><span class="co">#&gt; [34,] -0.075649567</span></span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a><span class="co">#&gt; [35,] -0.597267518</span></span>
<span id="cb18-45"><a href="#cb18-45" tabindex="-1"></a><span class="co">#&gt; [36,] -0.023658926</span></span>
<span id="cb18-46"><a href="#cb18-46" tabindex="-1"></a><span class="co">#&gt; [37,] -0.243104403</span></span>
<span id="cb18-47"><a href="#cb18-47" tabindex="-1"></a><span class="co">#&gt; [38,]  0.010358705</span></span>
<span id="cb18-48"><a href="#cb18-48" tabindex="-1"></a><span class="co">#&gt; [39,]  0.184225417</span></span>
<span id="cb18-49"><a href="#cb18-49" tabindex="-1"></a><span class="co">#&gt; [40,]  0.438392938</span></span>
<span id="cb18-50"><a href="#cb18-50" tabindex="-1"></a><span class="co">#&gt; [41,]  0.226713377</span></span>
<span id="cb18-51"><a href="#cb18-51" tabindex="-1"></a><span class="co">#&gt; [42,]  0.120151134</span></span>
<span id="cb18-52"><a href="#cb18-52" tabindex="-1"></a><span class="co">#&gt; [43,] -0.101919147</span></span>
<span id="cb18-53"><a href="#cb18-53" tabindex="-1"></a><span class="co">#&gt; [44,] -0.160244650</span></span>
<span id="cb18-54"><a href="#cb18-54" tabindex="-1"></a><span class="co">#&gt; [45,] -0.268316727</span></span>
<span id="cb18-55"><a href="#cb18-55" tabindex="-1"></a><span class="co">#&gt; [46,]  0.129485311</span></span>
<span id="cb18-56"><a href="#cb18-56" tabindex="-1"></a><span class="co">#&gt; [47,] -0.252536149</span></span>
<span id="cb18-57"><a href="#cb18-57" tabindex="-1"></a><span class="co">#&gt; [48,] -0.599875261</span></span>
<span id="cb18-58"><a href="#cb18-58" tabindex="-1"></a><span class="co">#&gt; [49,]  0.441202751</span></span>
<span id="cb18-59"><a href="#cb18-59" tabindex="-1"></a><span class="co">#&gt; [50,] -0.419224052</span></span>
<span id="cb18-60"><a href="#cb18-60" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" tabindex="-1"></a><span class="co"># To view individual model details and predictions:</span></span>
<span id="cb18-62"><a href="#cb18-62" tabindex="-1"></a><span class="co"># print(results$model_details) # you can uncomment this line of code and run it</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
